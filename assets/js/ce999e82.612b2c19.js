"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8997],{6432:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"block-gRPC","title":"Block gRPC Server","description":"Overview","source":"@site/docs/block-gRPC.md","sourceDirName":".","slug":"/block-gRPC","permalink":"/docs/block-gRPC","draft":false,"unlisted":false,"editUrl":"https://github.com/JupiterMetaZK/docs/edit/main/docs/block-gRPC.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Block Module","permalink":"/docs/block"},"next":{"title":"SmartContract Module","permalink":"/docs/smart-contract"}}');var c=s(4848),l=s(8453);const o={},i="Block gRPC Server",t={},d=[{value:"Overview",id:"overview",level:2},{value:"Starting the Server",id:"starting-the-server",level:2},{value:"API Endpoint",id:"api-endpoint",level:2},{value:"ProcessBlock",id:"processblock",level:3},{value:"Usage Example",id:"usage-example",level:2},{value:"Using gRPCurl (for testing)",id:"using-grpcurl-for-testing",level:3},{value:"Using Go Client",id:"using-go-client",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Key Features",id:"key-features",level:2},{value:"Comparison: REST vs gRPC",id:"comparison-rest-vs-grpc",level:2},{value:"Status Codes",id:"status-codes",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"block-grpc-server",children:"Block gRPC Server"})}),"\n",(0,c.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,c.jsx)(n.p,{children:"The Block gRPC server provides a gRPC interface for block processing operations, complementing the existing REST API."}),"\n",(0,c.jsx)(n.h2,{id:"starting-the-server",children:"Starting the Server"}),"\n",(0,c.jsxs)(n.p,{children:["The Block gRPC server can be started using the ",(0,c.jsx)(n.code,{children:"--blockgrpc"})," flag:"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"./jmdn --blockgen 8080 --blockgrpc 15055\n"})}),"\n",(0,c.jsx)(n.p,{children:"This starts:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"REST API on port 8080"}),"\n",(0,c.jsx)(n.li,{children:"gRPC server on port 15055"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"api-endpoint",children:"API Endpoint"}),"\n",(0,c.jsx)(n.h3,{id:"processblock",children:"ProcessBlock"}),"\n",(0,c.jsx)(n.p,{children:"Processes a ZK block through consensus and stores it."}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"gRPC Method:"})," ",(0,c.jsx)(n.code,{children:"BlockService.ProcessBlock"})]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Request:"})," ",(0,c.jsx)(n.code,{children:"ProcessBlockRequest"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-protobuf",children:"message ProcessBlockRequest {\n    ZKBlock block = 1;\n}\n"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"Response:"})," ",(0,c.jsx)(n.code,{children:"ProcessBlockResponse"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-protobuf",children:"message ProcessBlockResponse {\n    bool success = 1;\n    string message = 2;\n    string block_hash = 3;\n    uint64 block_number = 4;\n    string error = 5;\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"usage-example",children:"Usage Example"}),"\n",(0,c.jsx)(n.h3,{id:"using-grpcurl-for-testing",children:"Using gRPCurl (for testing)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# Convert your JSON block to base64 (for the stark_proof)\ncat block.json | grpcurl -plaintext \\\n  -d @ \\\n  localhost:15055 \\\n  Block.BlockService/ProcessBlock\n"})}),"\n",(0,c.jsx)(n.h3,{id:"using-go-client",children:"Using Go Client"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "context"\n    "fmt"\n    \n    pb "gossipnode/Block/proto"\n    "google.golang.org/grpc"\n    "google.golang.org/grpc/credentials/insecure"\n)\n\nfunc main() {\n    conn, err := grpc.NewClient("localhost:15055", \n        grpc.WithTransportCredentials(insecure.NewCredentials()))\n    if err != nil {\n        panic(err)\n    }\n    defer conn.Close()\n    \n    client := pb.NewBlockServiceClient(conn)\n    \n    // Create your block request\n    req := &pb.ProcessBlockRequest{\n        Block: &pb.ZKBlock{\n            BlockNumber: 1,\n            Status: "verified",\n            // ... other fields\n        },\n    }\n    \n    resp, err := client.ProcessBlock(context.Background(), req)\n    if err != nil {\n        panic(err)\n    }\n    \n    fmt.Printf("Success: %v\\n", resp.Success)\n    fmt.Printf("Block Hash: %s\\n", resp.BlockHash)\n}\n'})}),"\n",(0,c.jsx)(n.h2,{id:"architecture",children:"Architecture"}),"\n",(0,c.jsxs)(n.p,{children:["The gRPC server mirrors the REST API's ",(0,c.jsx)(n.code,{children:"processZKBlock"})," handler but uses:"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Protocol Buffers for serialization"}),"\n",(0,c.jsx)(n.li,{children:"gRPC for transport"}),"\n",(0,c.jsx)(n.li,{children:"Support for larger message sizes (50MB)"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"key-features",children:"Key Features"}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Consensus Integration"}),": Blocks go through the same consensus process as REST API"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Health Checks"}),": Includes gRPC health checking service"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Reflection"}),": gRPC reflection enabled for debugging"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Structured Logging"}),": All requests are logged to ",(0,c.jsx)(n.code,{children:"logs/block-grpc.log"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Error Handling"}),": Proper gRPC status codes for different error conditions"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"comparison-rest-vs-grpc",children:"Comparison: REST vs gRPC"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Feature"}),(0,c.jsx)(n.th,{children:"REST API"}),(0,c.jsx)(n.th,{children:"gRPC"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Protocol"}),(0,c.jsx)(n.td,{children:"HTTP/JSON"}),(0,c.jsx)(n.td,{children:"gRPC/Protobuf"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Port"}),(0,c.jsx)(n.td,{children:"Configurable"}),(0,c.jsx)(n.td,{children:"Configurable (separate)"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Message Size"}),(0,c.jsx)(n.td,{children:"Standard HTTP limits"}),(0,c.jsx)(n.td,{children:"50MB configured"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Serialization"}),(0,c.jsx)(n.td,{children:"JSON"}),(0,c.jsx)(n.td,{children:"Protobuf (more efficient)"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:"Use Case"}),(0,c.jsx)(n.td,{children:"Web clients, browsers"}),(0,c.jsx)(n.td,{children:"Internal services, mobile apps"})]})]})]}),"\n",(0,c.jsx)(n.h2,{id:"status-codes",children:"Status Codes"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"codes.InvalidArgument"}),": Block validation failed (no transactions, not verified)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"codes.Internal"}),": Consensus or processing errors"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"codes.OK"}),": Success"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>i});var r=s(6540);const c={},l=r.createContext(c);function o(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);