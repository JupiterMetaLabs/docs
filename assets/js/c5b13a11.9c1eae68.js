"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8350],{6336:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"gETH","title":"gETH Module","description":"Overview","source":"@site/docs/gETH.md","sourceDirName":".","slug":"/gETH","permalink":"/docs/gETH","draft":false,"unlisted":false,"editUrl":"https://github.com/JupiterMetaZK/docs/edit/main/docs/gETH.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"SmartContract Module","permalink":"/docs/smart-contract"},"next":{"title":"DB_OPs Module","permalink":"/docs/db_ops"}}');var c=i(4848),s=i(8453);const t={},l="gETH Module",o={},a=[{value:"Overview",id:"overview",level:2},{value:"Purpose",id:"purpose",level:2},{value:"Key Components",id:"key-components",level:2},{value:"1. gRPC Server",id:"1-grpc-server",level:3},{value:"2. gRPC Middleware",id:"2-grpc-middleware",level:3},{value:"3. gETH Configuration",id:"3-geth-configuration",level:3},{value:"4. HTTP Facade",id:"4-http-facade",level:3},{value:"5. WebSocket Facade",id:"5-websocket-facade",level:3},{value:"6. Service Layer",id:"6-service-layer",level:3},{value:"Key Functions",id:"key-functions",level:2},{value:"Get Block by Number",id:"get-block-by-number",level:3},{value:"Get Account State",id:"get-account-state",level:3},{value:"Submit Transaction",id:"submit-transaction",level:3},{value:"Usage",id:"usage",level:2},{value:"Starting gETH gRPC Server",id:"starting-geth-grpc-server",level:3},{value:"Starting gETH Facade Server",id:"starting-geth-facade-server",level:3},{value:"Using gRPC Client",id:"using-grpc-client",level:3},{value:"Using HTTP Facade (Ethereum JSON-RPC)",id:"using-http-facade-ethereum-json-rpc",level:3},{value:"Using WebSocket Facade",id:"using-websocket-facade",level:3},{value:"Integration Points",id:"integration-points",level:2},{value:"Block Module",id:"block-module",level:3},{value:"Database (DB_OPs)",id:"database-db_ops",level:3},{value:"Mempool Service",id:"mempool-service",level:3},{value:"Config Module",id:"config-module",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Logging",id:"logging",level:2},{value:"Security",id:"security",level:2},{value:"Performance",id:"performance",level:2},{value:"Testing",id:"testing",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"geth-module",children:"gETH Module"})}),"\n",(0,c.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,c.jsx)(n.p,{children:"The gETH module provides Ethereum-compatible interfaces for the JMZK network. It offers gRPC services and HTTP/WebSocket facades that implement Ethereum JSON-RPC API, enabling compatibility with existing Ethereum tooling and applications."}),"\n",(0,c.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,c.jsx)(n.p,{children:"The gETH module enables:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Ethereum-compatible blockchain interaction"}),"\n",(0,c.jsx)(n.li,{children:"gRPC services for blockchain operations"}),"\n",(0,c.jsx)(n.li,{children:"HTTP/WebSocket facades for JSON-RPC compatibility"}),"\n",(0,c.jsx)(n.li,{children:"Account state queries"}),"\n",(0,c.jsx)(n.li,{children:"Transaction submission"}),"\n",(0,c.jsx)(n.li,{children:"Block and transaction retrieval"}),"\n",(0,c.jsx)(n.li,{children:"Smart contract interaction"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,c.jsx)(n.h3,{id:"1-grpc-server",children:"1. gRPC Server"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"Server.go"})]}),"\n",(0,c.jsx)(n.p,{children:"Provides gRPC service for blockchain operations:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetBlockByNumber"}),": Get block by block number"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetBlockByHash"}),": Get block by block hash"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetTransactionByHash"}),": Get transaction by hash"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetReceiptByHash"}),": Get transaction receipt"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetAccountState"}),": Get account state (balance, nonce, etc.)"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"GetLogs"}),": Get event logs"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Call"}),": Execute contract call"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"EstimateGas"}),": Estimate gas for transaction"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"SendRawTx"}),": Submit raw transaction"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"2-grpc-middleware",children:"2. gRPC Middleware"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"gETH_Middleware.go"})]}),"\n",(0,c.jsx)(n.p,{children:"Core business logic for blockchain operations:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Block conversion from ZKBlock to Ethereum format"}),"\n",(0,c.jsx)(n.li,{children:"Transaction conversion"}),"\n",(0,c.jsx)(n.li,{children:"Receipt generation"}),"\n",(0,c.jsx)(n.li,{children:"Account state queries"}),"\n",(0,c.jsx)(n.li,{children:"Gas estimation"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"3-geth-configuration",children:"3. gETH Configuration"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"gETH_config.go"})]}),"\n",(0,c.jsx)(n.p,{children:"Data structures for Ethereum compatibility:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Block"}),": Ethereum-compatible block structure"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"BlockHeader"}),": Block header structure"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Transaction"}),": Transaction structure"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"Receipt"}),": Transaction receipt structure"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"4-http-facade",children:"4. HTTP Facade"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"Facade/rpc/http_server.go"})]}),"\n",(0,c.jsx)(n.p,{children:"HTTP server implementing Ethereum JSON-RPC API:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"JSON-RPC 2.0 protocol"}),"\n",(0,c.jsx)(n.li,{children:"Standard Ethereum endpoints"}),"\n",(0,c.jsx)(n.li,{children:"Error handling"}),"\n",(0,c.jsx)(n.li,{children:"Request validation"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"5-websocket-facade",children:"5. WebSocket Facade"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"Facade/rpc/ws_server.go"})]}),"\n",(0,c.jsx)(n.p,{children:"WebSocket server for real-time subscriptions:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"New block subscriptions"}),"\n",(0,c.jsx)(n.li,{children:"Event log subscriptions"}),"\n",(0,c.jsx)(n.li,{children:"Pending transaction subscriptions"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"6-service-layer",children:"6. Service Layer"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.strong,{children:"File:"})," ",(0,c.jsx)(n.code,{children:"Facade/Service/Service.go"})]}),"\n",(0,c.jsx)(n.p,{children:"Service interface and implementation:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Chain operations"}),"\n",(0,c.jsx)(n.li,{children:"Account operations"}),"\n",(0,c.jsx)(n.li,{children:"Transaction operations"}),"\n",(0,c.jsx)(n.li,{children:"Event operations"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,c.jsx)(n.h3,{id:"get-block-by-number",children:"Get Block by Number"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"// Get block by block number\nfunc _GetBlockByNumber(req *proto.GetBlockByNumberReq) (*proto.Block, error) {\n    // Get ZKBlock from database\n    // Convert to Ethereum format\n    // Return block\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"get-account-state",children:"Get Account State"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"// Get account state\nfunc _GetAccountState(req *proto.GetAccountStateReq) (*proto.AccountState, error) {\n    // Get account from database\n    // Get transactions\n    // Calculate nonce and balance\n    // Return account state\n}\n"})}),"\n",(0,c.jsx)(n.h3,{id:"submit-transaction",children:"Submit Transaction"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:"// Submit raw transaction\nfunc _SubmitRawTransaction(req *proto.SendRawTxReq) (*proto.SendRawTxResp, error) {\n    // Parse transaction\n    // Submit to mempool\n    // Return transaction hash\n}\n"})}),"\n",(0,c.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,c.jsx)(n.h3,{id:"starting-geth-grpc-server",children:"Starting gETH gRPC Server"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# Start node with gETH gRPC server\n./jmdn -geth 15054\n"})}),"\n",(0,c.jsx)(n.h3,{id:"starting-geth-facade-server",children:"Starting gETH Facade Server"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# Start node with gETH facade (HTTP/WebSocket)\n./jmdn -facade 8545 -ws 8546\n"})}),"\n",(0,c.jsx)(n.h3,{id:"using-grpc-client",children:"Using gRPC Client"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-go",children:'import "gossipnode/gETH/proto"\n\n// Connect to gRPC server\nconn, _ := grpc.Dial("localhost:15054", grpc.WithInsecure())\nclient := proto.NewGETHServiceClient(conn)\n\n// Get block by number\nblock, _ := client.GetBlockByNumber(ctx, &proto.GetBlockByNumberReq{Number: 123})\n\n// Get account state\nstate, _ := client.GetAccountState(ctx, &proto.GetAccountStateReq{Address: addr})\n'})}),"\n",(0,c.jsx)(n.h3,{id:"using-http-facade-ethereum-json-rpc",children:"Using HTTP Facade (Ethereum JSON-RPC)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'# Get block by number\ncurl -X POST http://localhost:8545 \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "jsonrpc": "2.0",\n    "method": "eth_getBlockByNumber",\n    "params": ["0x7b", true],\n    "id": 1\n  }\'\n\n# Get account balance\ncurl -X POST http://localhost:8545 \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "jsonrpc": "2.0",\n    "method": "eth_getBalance",\n    "params": ["0x1234...", "latest"],\n    "id": 1\n  }\'\n\n# Send raw transaction\ncurl -X POST http://localhost:8545 \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "jsonrpc": "2.0",\n    "method": "eth_sendRawTransaction",\n    "params": ["0x..."],\n    "id": 1\n  }\'\n'})}),"\n",(0,c.jsx)(n.h3,{id:"using-websocket-facade",children:"Using WebSocket Facade"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:'// Connect to WebSocket\nconst ws = new WebSocket(\'ws://localhost:8546\');\n\n// Subscribe to new blocks\nws.send(JSON.stringify({\n  jsonrpc: "2.0",\n  method: "eth_subscribe",\n  params: ["newHeads"],\n  id: 1\n}));\n\n// Receive block updates\nws.onmessage = (event) => {\n  const data = JSON.parse(event.data);\n  console.log(\'New block:\', data);\n};\n'})}),"\n",(0,c.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,c.jsx)(n.h3,{id:"block-module",children:"Block Module"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Uses block data structures"}),"\n",(0,c.jsx)(n.li,{children:"Accesses block operations"}),"\n",(0,c.jsx)(n.li,{children:"Submits transactions to mempool"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"database-db_ops",children:"Database (DB_OPs)"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Queries blocks and transactions"}),"\n",(0,c.jsx)(n.li,{children:"Retrieves account information"}),"\n",(0,c.jsx)(n.li,{children:"Accesses receipt data"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"mempool-service",children:"Mempool Service"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Submits transactions"}),"\n",(0,c.jsx)(n.li,{children:"Queries transaction status"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"config-module",children:"Config Module"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Uses chain ID configuration"}),"\n",(0,c.jsx)(n.li,{children:"Accesses network parameters"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,c.jsx)(n.p,{children:"gETH server ports can be configured via command-line flags:"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"./jmdn -geth 15054      # gRPC server port\n./jmdn -facade 8545     # HTTP facade port\n./jmdn -ws 8546         # WebSocket facade port\n./jmdn -chainID 7000700 # Chain ID\n"})}),"\n",(0,c.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,c.jsx)(n.p,{children:"The module includes comprehensive error handling:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Invalid block number errors"}),"\n",(0,c.jsx)(n.li,{children:"Transaction validation errors"}),"\n",(0,c.jsx)(n.li,{children:"Account not found errors"}),"\n",(0,c.jsx)(n.li,{children:"Network errors"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,c.jsx)(n.p,{children:"gETH operations are logged to:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"logs/gETH.log"}),": gETH operations"]}),"\n",(0,c.jsx)(n.li,{children:"Loki (if enabled): Centralized logging"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Transaction signature verification"}),"\n",(0,c.jsx)(n.li,{children:"Input validation"}),"\n",(0,c.jsx)(n.li,{children:"Rate limiting (via middleware)"}),"\n",(0,c.jsx)(n.li,{children:"Error message sanitization"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Efficient block conversion"}),"\n",(0,c.jsx)(n.li,{children:"Connection pooling"}),"\n",(0,c.jsx)(n.li,{children:"Batch operations"}),"\n",(0,c.jsx)(n.li,{children:"Caching for frequently accessed data"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,c.jsx)(n.p,{children:"Test files:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"gETH_test.go"}),": gETH operation tests"]}),"\n",(0,c.jsx)(n.li,{children:"gRPC service tests"}),"\n",(0,c.jsx)(n.li,{children:"HTTP facade tests"}),"\n",(0,c.jsx)(n.li,{children:"WebSocket tests"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Enhanced Ethereum compatibility"}),"\n",(0,c.jsx)(n.li,{children:"Advanced smart contract support"}),"\n",(0,c.jsx)(n.li,{children:"Improved gas estimation"}),"\n",(0,c.jsx)(n.li,{children:"Performance optimizations"}),"\n",(0,c.jsx)(n.li,{children:"Additional JSON-RPC methods"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(6540);const c={},s=r.createContext(c);function t(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);