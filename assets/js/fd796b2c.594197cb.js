"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4548],{7715:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"smart-contract","title":"SmartContract Module","description":"Overview","source":"@site/docs/smart-contract.md","sourceDirName":".","slug":"/smart-contract","permalink":"/docs/smart-contract","draft":false,"unlisted":false,"editUrl":"https://github.com/JupiterMetaZK/docs/edit/main/docs/smart-contract.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Block gRPC Server","permalink":"/docs/block-gRPC"},"next":{"title":"gETH Module","permalink":"/docs/gETH"}}');var l=t(4848),r=t(8453);const c={},o="SmartContract Module",s={},a=[{value:"Overview",id:"overview",level:2},{value:"Purpose",id:"purpose",level:2},{value:"Key Components",id:"key-components",level:2},{value:"1. Compiler",id:"1-compiler",level:3},{value:"2. EVM Executor",id:"2-evm-executor",level:3},{value:"3. State Database",id:"3-state-database",level:3},{value:"4. State Database Helper",id:"4-state-database-helper",level:3},{value:"5. EVM Helper",id:"5-evm-helper",level:3},{value:"Key Functions",id:"key-functions",level:2},{value:"Compile Solidity",id:"compile-solidity",level:3},{value:"Deploy Contract",id:"deploy-contract",level:3},{value:"Execute Contract",id:"execute-contract",level:3},{value:"Usage",id:"usage",level:2},{value:"Compile Contract",id:"compile-contract",level:3},{value:"Deploy Contract",id:"deploy-contract-1",level:3},{value:"Execute Contract",id:"execute-contract-1",level:3},{value:"Integration Points",id:"integration-points",level:2},{value:"Block Module",id:"block-module",level:3},{value:"gETH Module",id:"geth-module",level:3},{value:"Database (DB_OPs)",id:"database-db_ops",level:3},{value:"Config Module",id:"config-module",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Logging",id:"logging",level:2},{value:"Security",id:"security",level:2},{value:"Performance",id:"performance",level:2},{value:"Testing",id:"testing",level:2},{value:"Example Contract",id:"example-contract",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"smartcontract-module",children:"SmartContract Module"})}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"The SmartContract module provides smart contract compilation and execution capabilities for the JMZK network. It supports Solidity compilation, EVM execution, and state management for smart contracts."}),"\n",(0,l.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,l.jsx)(n.p,{children:"The SmartContract module enables:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Solidity contract compilation"}),"\n",(0,l.jsx)(n.li,{children:"EVM contract execution"}),"\n",(0,l.jsx)(n.li,{children:"Contract deployment"}),"\n",(0,l.jsx)(n.li,{children:"Contract state management"}),"\n",(0,l.jsx)(n.li,{children:"ABI encoding and decoding"}),"\n",(0,l.jsx)(n.li,{children:"Gas estimation"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,l.jsx)(n.h3,{id:"1-compiler",children:"1. Compiler"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"compiler.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Solidity contract compilation:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CompileSolidity"}),": Compile Solidity source files"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CompiledContract"}),": Compiled contract structure"]}),"\n",(0,l.jsx)(n.li,{children:"Standard JSON input/output format"}),"\n",(0,l.jsx)(n.li,{children:"Optimizer configuration"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-evm-executor",children:"2. EVM Executor"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"evm.go"})]}),"\n",(0,l.jsx)(n.p,{children:"EVM execution environment:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"EVMExecutor"}),": EVM execution manager"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"NewEVMExecutor"}),": Create new EVM executor"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"DeployContract"}),": Deploy smart contract"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ExecuteContract"}),": Execute contract function"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ExecutionResult"}),": Execution result structure"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-state-database",children:"3. State Database"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"statedb.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Contract state management:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"State database implementation"}),"\n",(0,l.jsx)(n.li,{children:"Account balance management"}),"\n",(0,l.jsx)(n.li,{children:"Storage management"}),"\n",(0,l.jsx)(n.li,{children:"Nonce management"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"4-state-database-helper",children:"4. State Database Helper"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"statedbHelper.go"})]}),"\n",(0,l.jsx)(n.p,{children:"State database utilities:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Helper functions for state operations"}),"\n",(0,l.jsx)(n.li,{children:"Account management"}),"\n",(0,l.jsx)(n.li,{children:"Storage operations"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"5-evm-helper",children:"5. EVM Helper"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"EVMHelper.go"})]}),"\n",(0,l.jsx)(n.p,{children:"EVM utility functions:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Hash function implementation"}),"\n",(0,l.jsx)(n.li,{children:"Block context management"}),"\n",(0,l.jsx)(n.li,{children:"Transaction context management"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,l.jsx)(n.h3,{id:"compile-solidity",children:"Compile Solidity"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Compile Solidity contract\nfunc CompileSolidity(sourcePath string) (map[string]*CompiledContract, error) {\n    // Read source code\n    // Create standard JSON input\n    // Run solc compiler\n    // Parse output\n    // Return compiled contracts\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"deploy-contract",children:"Deploy Contract"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Deploy smart contract\nfunc (e *EVMExecutor) DeployContract(state vm.StateDB, caller common.Address,\n    code []byte, value *big.Int, gasLimit uint64) (*ExecutionResult, error) {\n    // Create EVM instance\n    // Deploy contract\n    // Return execution result\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"execute-contract",children:"Execute Contract"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Execute contract function\nfunc (e *EVMExecutor) ExecuteContract(state vm.StateDB, caller common.Address,\n    contractAddr common.Address, input []byte, value *big.Int, gasLimit uint64) (*ExecutionResult, error) {\n    // Create EVM instance\n    // Call contract function\n    // Return execution result\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(n.h3,{id:"compile-contract",children:"Compile Contract"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:'import "gossipnode/SmartContract"\n\n// Compile Solidity contract\ncontracts, err := SmartContract.CompileSolidity("./SmartContract/example/SimpleToken.sol")\nif err != nil {\n    log.Fatal(err)\n}\n\n// Access compiled contract\ncontract := contracts["SimpleToken"]\nfmt.Printf("Bytecode: %s\\n", contract.Bytecode)\nfmt.Printf("ABI: %s\\n", contract.ABI)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"deploy-contract-1",children:"Deploy Contract"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:'import "gossipnode/SmartContract"\n\n// Create EVM executor\nexecutor := SmartContract.NewEVMExecutor(chainID)\n\n// Deploy contract\nresult, err := executor.DeployContract(state, caller, code, value, gasLimit)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf("Contract deployed at: %s\\n", result.ContractAddr.Hex())\n'})}),"\n",(0,l.jsx)(n.h3,{id:"execute-contract-1",children:"Execute Contract"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:'// Execute contract function\nresult, err := executor.ExecuteContract(state, caller, contractAddr, input, value, gasLimit)\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf("Return data: %x\\n", result.ReturnData)\nfmt.Printf("Gas used: %d\\n", result.GasUsed)\n'})}),"\n",(0,l.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,l.jsx)(n.h3,{id:"block-module",children:"Block Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Executes smart contracts in blocks"}),"\n",(0,l.jsx)(n.li,{children:"Processes contract transactions"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"geth-module",children:"gETH Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Provides contract execution via gRPC"}),"\n",(0,l.jsx)(n.li,{children:"Handles contract calls"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"database-db_ops",children:"Database (DB_OPs)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Stores contract state"}),"\n",(0,l.jsx)(n.li,{children:"Manages contract accounts"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"config-module",children:"Config Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Uses chain ID configuration"}),"\n",(0,l.jsx)(n.li,{children:"Accesses transaction structures"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsx)(n.p,{children:"Smart contract configuration:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Solidity compiler path (default: ",(0,l.jsx)(n.code,{children:"solc"}),")"]}),"\n",(0,l.jsx)(n.li,{children:"Optimizer settings (default: enabled, 200 runs)"}),"\n",(0,l.jsx)(n.li,{children:"EVM version (default: london)"}),"\n",(0,l.jsxs)(n.li,{children:["Artifacts directory (default: ",(0,l.jsx)(n.code,{children:"./SmartContract/artifacts"}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.p,{children:"The module includes comprehensive error handling:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Compilation errors"}),"\n",(0,l.jsx)(n.li,{children:"Execution errors"}),"\n",(0,l.jsx)(n.li,{children:"State errors"}),"\n",(0,l.jsx)(n.li,{children:"Gas estimation errors"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,l.jsx)(n.p,{children:"Smart contract operations are logged to:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Application logs"}),"\n",(0,l.jsx)(n.li,{children:"Compilation logs"}),"\n",(0,l.jsx)(n.li,{children:"Execution logs"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Contract validation"}),"\n",(0,l.jsx)(n.li,{children:"Gas limit enforcement"}),"\n",(0,l.jsx)(n.li,{children:"State isolation"}),"\n",(0,l.jsx)(n.li,{children:"Input sanitization"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Efficient EVM execution"}),"\n",(0,l.jsx)(n.li,{children:"Optimized state management"}),"\n",(0,l.jsx)(n.li,{children:"Fast compilation"}),"\n",(0,l.jsx)(n.li,{children:"Gas optimization"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,l.jsx)(n.p,{children:"Test files:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"SmartContract_test.go"}),": Smart contract tests"]}),"\n",(0,l.jsx)(n.li,{children:"Compilation tests"}),"\n",(0,l.jsx)(n.li,{children:"Execution tests"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"example-contract",children:"Example Contract"}),"\n",(0,l.jsxs)(n.p,{children:["See ",(0,l.jsx)(n.code,{children:"SmartContract/example/SimpleToken.sol"})," for an example Solidity contract."]}),"\n",(0,l.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Enhanced compiler support"}),"\n",(0,l.jsx)(n.li,{children:"Improved EVM execution"}),"\n",(0,l.jsx)(n.li,{children:"Better gas estimation"}),"\n",(0,l.jsx)(n.li,{children:"Performance optimizations"}),"\n",(0,l.jsx)(n.li,{children:"Additional contract languages"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(6540);const l={},r=i.createContext(l);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);