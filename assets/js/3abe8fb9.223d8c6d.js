"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4485],{6180:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>a,frontMatter:()=>g,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"logging","title":"Logging Module","description":"Overview","source":"@site/docs/logging.md","sourceDirName":".","slug":"/logging","permalink":"/docs/logging","draft":false,"unlisted":false,"editUrl":"https://github.com/JupiterMetaZK/docs/edit/main/docs/logging.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"DID Module","permalink":"/docs/did-module"},"next":{"title":"CLI Module","permalink":"/docs/cli"}}');var o=i(4848),r=i(8453);const g={},s="Logging Module",d={},c=[{value:"Overview",id:"overview",level:2},{value:"Purpose",id:"purpose",level:2},{value:"Key Components",id:"key-components",level:2},{value:"1. Async Logger",id:"1-async-logger",level:3},{value:"2. Logger Builder",id:"2-logger-builder",level:3},{value:"3. Log Configuration",id:"3-log-configuration",level:3},{value:"4. Loki Integration",id:"4-loki-integration",level:3},{value:"Key Functions",id:"key-functions",level:2},{value:"Create Logger",id:"create-logger",level:3},{value:"Using Logger Builder",id:"using-logger-builder",level:3},{value:"Logging Messages",id:"logging-messages",level:3},{value:"Global Logger",id:"global-logger",level:3},{value:"Usage",id:"usage",level:2},{value:"Basic Logging",id:"basic-logging",level:3},{value:"Logging with Loki",id:"logging-with-loki",level:3},{value:"Using Logger Builder",id:"using-logger-builder-1",level:3},{value:"Global Logger",id:"global-logger-1",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Log File Configuration",id:"log-file-configuration",level:3},{value:"Loki Configuration",id:"loki-configuration",level:3},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Integration Points",id:"integration-points",level:2},{value:"All Modules",id:"all-modules",level:3},{value:"Config Module",id:"config-module",level:3},{value:"Node Module",id:"node-module",level:3},{value:"Block Module",id:"block-module",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Performance",id:"performance",level:2},{value:"Testing",id:"testing",level:2},{value:"Best Practices",id:"best-practices",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"logging-module",children:"Logging Module"})}),"\n",(0,o.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(n.p,{children:"The Logging module provides structured logging capabilities for the JMZK network. It supports both file-based logging and centralized logging via Loki, with async logging for performance."}),"\n",(0,o.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,o.jsx)(n.p,{children:"The Logging module enables:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Structured logging with Zap logger"}),"\n",(0,o.jsx)(n.li,{children:"File-based logging"}),"\n",(0,o.jsx)(n.li,{children:"Centralized logging via Loki"}),"\n",(0,o.jsx)(n.li,{children:"Async logging for performance"}),"\n",(0,o.jsx)(n.li,{children:"Log level management"}),"\n",(0,o.jsx)(n.li,{children:"Topic-based logging"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,o.jsx)(n.h3,{id:"1-async-logger",children:"1. Async Logger"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"File:"})," ",(0,o.jsx)(n.code,{children:"log.go"})]}),"\n",(0,o.jsx)(n.p,{children:"Main logging implementation:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"AsyncLogger"}),": Async logger with file and Loki support"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"NewAsyncLogger"}),": Create new async logger"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ReturnDefaultLogger"}),": Create default logger"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"ReturnDefaultLoggerWithLoki"}),": Create logger with Loki support"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"2-logger-builder",children:"2. Logger Builder"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"File:"})," ",(0,o.jsx)(n.code,{children:"Builder.go"})]}),"\n",(0,o.jsx)(n.p,{children:"Builder pattern for logger configuration:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"LoggerBuilder"}),": Builder for logger configuration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"NewLoggerBuilder"}),": Create new logger builder"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"SetFileName"}),": Set log file name"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"SetTopic"}),": Set log topic"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"SetURL"}),": Set Loki URL"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Build"}),": Build logger instance"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"3-log-configuration",children:"3. Log Configuration"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"File:"})," ",(0,o.jsx)(n.code,{children:"LogConfig.go"})]}),"\n",(0,o.jsx)(n.p,{children:"Logging configuration structures:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Logging"}),": Main logging configuration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"LoggingMetadata"}),": Logging metadata configuration"]}),"\n",(0,o.jsx)(n.li,{children:"Log level constants"}),"\n",(0,o.jsx)(n.li,{children:"Log format configuration"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"4-loki-integration",children:"4. Loki Integration"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"File:"})," ",(0,o.jsx)(n.code,{children:"loki.go"})]}),"\n",(0,o.jsx)(n.p,{children:"Loki client integration:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"lokiWriteSyncer"}),": Loki write syncer"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"newLokiWriteSyncer"}),": Create new Loki write syncer"]}),"\n",(0,o.jsx)(n.li,{children:"Batch logging support"}),"\n",(0,o.jsx)(n.li,{children:"Retry logic"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,o.jsx)(n.h3,{id:"create-logger",children:"Create Logger"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'// Create default logger\nlogger, err := logging.ReturnDefaultLogger("app.log", "app")\n\n// Create logger with Loki\nlogger, err := logging.ReturnDefaultLoggerWithLoki("app.log", "app", true)\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-logger-builder",children:"Using Logger Builder"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'// Create logger with builder\nlogger, err := logging.NewLoggerBuilder().\n    SetFileName("app.log").\n    SetTopic("app").\n    SetURL("http://localhost:3100/loki/api/v1/push").\n    Build()\n'})}),"\n",(0,o.jsx)(n.h3,{id:"logging-messages",children:"Logging Messages"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'// Log info message\nlogger.Logger.Info("Message", zap.String("key", "value"))\n\n// Log error message\nlogger.Logger.Error("Error", zap.Error(err))\n\n// Log debug message\nlogger.Logger.Debug("Debug", zap.String("key", "value"))\n\n// Log warn message\nlogger.Logger.Warn("Warning", zap.String("key", "value"))\n'})}),"\n",(0,o.jsx)(n.h3,{id:"global-logger",children:"Global Logger"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'// Set global logger\nlogging.SetGlobalLogger(logger)\n\n// Get global logger\nlogger := logging.GetGlobalLogger()\n\n// Log with global logger\nlogging.LogInfo("Message", zap.String("key", "value"))\nlogging.LogError("Error", zap.Error(err))\n'})}),"\n",(0,o.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsx)(n.h3,{id:"basic-logging",children:"Basic Logging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'import "gossipnode/logging"\n\n// Create logger\nlogger, err := logging.ReturnDefaultLogger("app.log", "app")\nif err != nil {\n    log.Fatal(err)\n}\ndefer logger.Close()\n\n// Log messages\nlogger.Logger.Info("Application started")\nlogger.Logger.Error("Error occurred", zap.Error(err))\n'})}),"\n",(0,o.jsx)(n.h3,{id:"logging-with-loki",children:"Logging with Loki"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'import "gossipnode/logging"\n\n// Create logger with Loki\nlogger, err := logging.ReturnDefaultLoggerWithLoki("app.log", "app", true)\nif err != nil {\n    log.Fatal(err)\n}\ndefer logger.Close()\n\n// Log messages (automatically sent to Loki)\nlogger.Logger.Info("Application started")\n'})}),"\n",(0,o.jsx)(n.h3,{id:"using-logger-builder-1",children:"Using Logger Builder"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'import "gossipnode/logging"\n\n// Create logger with builder\nlogger, err := logging.NewLoggerBuilder().\n    SetFileName("app.log").\n    SetTopic("app").\n    SetDirectory("logs").\n    SetBatchSize(100).\n    SetBatchWait(2 * time.Second).\n    SetTimeout(6 * time.Second).\n    SetURL("http://localhost:3100/loki/api/v1/push").\n    Build()\nif err != nil {\n    log.Fatal(err)\n}\ndefer logger.Close()\n\n// Log messages\nlogger.Logger.Info("Application started")\n'})}),"\n",(0,o.jsx)(n.h3,{id:"global-logger-1",children:"Global Logger"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'import "gossipnode/logging"\n\n// Set global logger\nlogger, _ := logging.ReturnDefaultLogger("app.log", "app")\nlogging.SetGlobalLogger(logger)\n\n// Use global logger\nlogging.LogInfo("Message", zap.String("key", "value"))\nlogging.LogError("Error", zap.Error(err))\n'})}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(n.h3,{id:"log-file-configuration",children:"Log File Configuration"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"FileName"}),': Log file name (e.g., "app.log")']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Directory"}),': Log directory (default: "logs")']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Topic"}),": Log topic for categorization"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"loki-configuration",children:"Loki Configuration"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"URL"}),': Loki URL (default: "',(0,o.jsx)(n.a,{href:"http://localhost:3100/loki/api/v1/push",children:"http://localhost:3100/loki/api/v1/push"}),'")']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"BatchSize"}),": Batch size for Loki (default: 100)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"BatchWait"}),": Batch wait time (default: 2 seconds)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Timeout"}),": Timeout for Loki requests (default: 6 seconds)"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"LOKI_URL"}),": Override Loki URL from environment"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,o.jsx)(n.h3,{id:"all-modules",children:"All Modules"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"All modules use logging for structured logging"}),"\n",(0,o.jsx)(n.li,{children:"Consistent logging format across modules"}),"\n",(0,o.jsx)(n.li,{children:"Centralized logging via Loki"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"config-module",children:"Config Module"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Uses logging for connection pool logging"}),"\n",(0,o.jsx)(n.li,{children:"Logs database operations"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"node-module",children:"Node Module"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Uses logging for node operations"}),"\n",(0,o.jsx)(n.li,{children:"Logs peer connections"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"block-module",children:"Block Module"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Uses logging for block operations"}),"\n",(0,o.jsx)(n.li,{children:"Logs transaction processing"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,o.jsx)(n.p,{children:"The module includes comprehensive error handling:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"File creation errors"}),"\n",(0,o.jsx)(n.li,{children:"Loki connection errors"}),"\n",(0,o.jsx)(n.li,{children:"Batch processing errors"}),"\n",(0,o.jsx)(n.li,{children:"Timeout errors"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Async Logging"}),": Non-blocking log writes"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Batch Processing"}),": Efficient batch writes to Loki"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Buffering"}),": Buffered writes for performance"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Connection Pooling"}),": Efficient Loki connections"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,o.jsx)(n.p,{children:"Test files:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"Test/log_test.go"}),": Logging tests"]}),"\n",(0,o.jsx)(n.li,{children:"Logger builder tests"}),"\n",(0,o.jsx)(n.li,{children:"Loki integration tests"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use structured logging"}),": Include context with log messages"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Set appropriate log levels"}),": Use DEBUG, INFO, WARN, ERROR appropriately"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Close loggers"}),": Always close loggers on shutdown"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Use topics"}),": Categorize logs by topic"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Monitor Loki"}),": Monitor Loki for centralized logging"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Enhanced log filtering"}),"\n",(0,o.jsx)(n.li,{children:"Advanced log rotation"}),"\n",(0,o.jsx)(n.li,{children:"Performance optimizations"}),"\n",(0,o.jsx)(n.li,{children:"Additional log backends"}),"\n",(0,o.jsx)(n.li,{children:"Log aggregation improvements"}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>g,x:()=>s});var l=i(6540);const o={},r=l.createContext(o);function g(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:g(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);