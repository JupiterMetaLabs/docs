"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7122],{4832:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>a,frontMatter:()=>o,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"sequencer","title":"Sequencer Module","description":"Overview","source":"@site/docs/sequencer.md","sourceDirName":".","slug":"/sequencer","permalink":"/docs/sequencer","draft":false,"unlisted":false,"editUrl":"https://github.com/JupiterMetaZK/docs/edit/main/docs/sequencer.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"BFT Implementation Documentation","permalink":"/docs/bft"},"next":{"title":"Block Module","permalink":"/docs/block"}}');var l=s(4848),r=s(8453);const o={},d="Sequencer Module",c={},t=[{value:"Overview",id:"overview",level:2},{value:"Purpose",id:"purpose",level:2},{value:"Key Components",id:"key-components",level:2},{value:"1. Consensus",id:"1-consensus",level:3},{value:"2. Communication",id:"2-communication",level:3},{value:"3. Router",id:"3-router",level:3},{value:"4. Metadata",id:"4-metadata",level:3},{value:"5. Triggers",id:"5-triggers",level:3},{value:"Key Functions",id:"key-functions",level:2},{value:"Start Consensus",id:"start-consensus",level:3},{value:"Query Buddy Nodes",id:"query-buddy-nodes",level:3},{value:"Request Vote Results",id:"request-vote-results",level:3},{value:"Usage",id:"usage",level:2},{value:"Create Consensus Instance",id:"create-consensus-instance",level:3},{value:"Start Consensus",id:"start-consensus-1",level:3},{value:"Integration Points",id:"integration-points",level:2},{value:"AVC Module",id:"avc-module",level:3},{value:"PubSub Module",id:"pubsub-module",level:3},{value:"Messaging Module",id:"messaging-module",level:3},{value:"Block Module",id:"block-module",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Logging",id:"logging",level:2},{value:"Security",id:"security",level:2},{value:"Performance",id:"performance",level:2},{value:"Testing",id:"testing",level:2},{value:"Future Enhancements",id:"future-enhancements",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"sequencer-module",children:"Sequencer Module"})}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsx)(n.p,{children:"The Sequencer module provides consensus orchestration for the JMZK network. It manages buddy node selection, consensus initiation, vote collection, and BFT consensus execution."}),"\n",(0,l.jsx)(n.h2,{id:"purpose",children:"Purpose"}),"\n",(0,l.jsx)(n.p,{children:"The Sequencer module enables:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Consensus orchestration for block validation"}),"\n",(0,l.jsx)(n.li,{children:"Buddy node selection and management"}),"\n",(0,l.jsx)(n.li,{children:"Vote collection from buddy nodes"}),"\n",(0,l.jsx)(n.li,{children:"BFT consensus execution"}),"\n",(0,l.jsx)(n.li,{children:"PubSub channel management for consensus"}),"\n",(0,l.jsx)(n.li,{children:"CRDT synchronization for buddy nodes"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"key-components",children:"Key Components"}),"\n",(0,l.jsx)(n.h3,{id:"1-consensus",children:"1. Consensus"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"Consensus.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Main consensus orchestration:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"NewConsensus"}),": Create new consensus instance"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Start"}),": Start consensus process"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"QueryBuddyNodes"}),": Query and select buddy nodes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"RequestSubscriptionPermission"}),": Request subscription from buddy nodes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"CreatePubSubChannel"}),": Create PubSub channel for consensus"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-communication",children:"2. Communication"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"Communication.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Communication with buddy nodes:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"AskForSubscription"}),": Ask buddy nodes to subscribe to consensus channel"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"RequestVoteResultsFromBuddies"}),": Request vote results from buddy nodes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"StartBFTConsensus"}),": Start BFT consensus process"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-router",children:"3. Router"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"Router/Router.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Routing for consensus operations:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Message routing"}),"\n",(0,l.jsx)(n.li,{children:"Vote aggregation"}),"\n",(0,l.jsx)(n.li,{children:"Response handling"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"4-metadata",children:"4. Metadata"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"Metadata/Metadata.go"})]}),"\n",(0,l.jsx)(n.p,{children:"Consensus metadata management:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Block metadata"}),"\n",(0,l.jsx)(n.li,{children:"Vote metadata"}),"\n",(0,l.jsx)(n.li,{children:"Consensus state"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"5-triggers",children:"5. Triggers"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File:"})," ",(0,l.jsx)(n.code,{children:"Triggers/"})]}),"\n",(0,l.jsx)(n.p,{children:"Consensus triggers:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Triggers.go"}),": Trigger management"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Maps.go"}),": Vote result maps"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"key-functions",children:"Key Functions"}),"\n",(0,l.jsx)(n.h3,{id:"start-consensus",children:"Start Consensus"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Start consensus process\nfunc (c *Consensus) Start(block *config.ZKBlock) error {\n    // Query buddy nodes\n    // Create PubSub channel\n    // Request subscriptions\n    // Collect votes\n    // Execute BFT consensus\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"query-buddy-nodes",children:"Query Buddy Nodes"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Query and select buddy nodes\nfunc (c *Consensus) QueryBuddyNodes() error {\n    // Use VRF to select buddy nodes\n    // Connect to buddy nodes\n    // Populate peer list\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"request-vote-results",children:"Request Vote Results"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Request vote results from buddy nodes\nfunc RequestVoteResultsFromBuddies() error {\n    // Request votes from all buddy nodes\n    // Collect vote results\n    // Aggregate votes\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,l.jsx)(n.h3,{id:"create-consensus-instance",children:"Create Consensus Instance"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:'import "gossipnode/Sequencer"\n\n// Create consensus instance\npeerList := Sequencer.PeerList{\n    MainPeers:   []peer.ID{},\n    BackupPeers: []peer.ID{},\n}\nconsensus := Sequencer.NewConsensus(peerList, host)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"start-consensus-1",children:"Start Consensus"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-go",children:"// Start consensus for block\nerr := consensus.Start(block)\nif err != nil {\n    log.Error(err)\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,l.jsx)(n.h3,{id:"avc-module",children:"AVC Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Uses BFT for consensus execution"}),"\n",(0,l.jsx)(n.li,{children:"Integrates with buddy nodes"}),"\n",(0,l.jsx)(n.li,{children:"Uses node selection for buddy selection"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"pubsub-module",children:"PubSub Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Uses PubSub for consensus messaging"}),"\n",(0,l.jsx)(n.li,{children:"Creates private channels for consensus"}),"\n",(0,l.jsx)(n.li,{children:"Manages subscriptions"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"messaging-module",children:"Messaging Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Uses messaging for vote collection"}),"\n",(0,l.jsx)(n.li,{children:"Integrates with direct messaging"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"block-module",children:"Block Module"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Initiates consensus for block validation"}),"\n",(0,l.jsx)(n.li,{children:"Receives consensus results"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,l.jsxs)(n.p,{children:["Key configuration in ",(0,l.jsx)(n.code,{children:"config/"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"MaxMainPeers"}),": Maximum main buddy nodes (default: 13)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"MaxBackupPeers"}),": Maximum backup buddy nodes (default: 10)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"ConsensusTimeout"}),": Consensus timeout (default: 20 seconds)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"PubSub_ConsensusChannel"}),": Consensus channel name"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Pubsub_CRDTSync"}),": CRDT sync channel name"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,l.jsx)(n.p,{children:"The module includes comprehensive error handling:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Buddy node selection errors"}),"\n",(0,l.jsx)(n.li,{children:"Subscription errors"}),"\n",(0,l.jsx)(n.li,{children:"Vote collection errors"}),"\n",(0,l.jsx)(n.li,{children:"BFT consensus errors"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"logging",children:"Logging"}),"\n",(0,l.jsx)(n.p,{children:"Sequencer operations are logged to:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Application logs"}),"\n",(0,l.jsx)(n.li,{children:"Consensus logs"}),"\n",(0,l.jsx)(n.li,{children:"Error logs"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"security",children:"Security"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Buddy node authentication"}),"\n",(0,l.jsx)(n.li,{children:"Vote signature verification"}),"\n",(0,l.jsx)(n.li,{children:"BFT consensus security"}),"\n",(0,l.jsx)(n.li,{children:"Private channel access control"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Efficient buddy node selection"}),"\n",(0,l.jsx)(n.li,{children:"Concurrent vote collection"}),"\n",(0,l.jsx)(n.li,{children:"Optimized BFT execution"}),"\n",(0,l.jsx)(n.li,{children:"PubSub channel management"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,l.jsx)(n.p,{children:"Test files:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Sequencer_test.go"}),": Sequencer operation tests"]}),"\n",(0,l.jsx)(n.li,{children:"Integration tests"}),"\n",(0,l.jsx)(n.li,{children:"Consensus simulation tests"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"future-enhancements",children:"Future Enhancements"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Enhanced consensus algorithms"}),"\n",(0,l.jsx)(n.li,{children:"Improved buddy node selection"}),"\n",(0,l.jsx)(n.li,{children:"Better error recovery"}),"\n",(0,l.jsx)(n.li,{children:"Performance optimizations"}),"\n",(0,l.jsx)(n.li,{children:"Additional consensus mechanisms"}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var i=s(6540);const l={},r=i.createContext(l);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);