<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-seednode-core" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Seed Node | JupiterMetaZK Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.zkjm.io/docs/seednode-core"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Seed Node | JupiterMetaZK Documentation"><meta data-rh="true" name="description" content="A decentralized peer directory service for the JMDT network."><meta data-rh="true" property="og:description" content="A decentralized peer directory service for the JMDT network."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.zkjm.io/docs/seednode-core"><link data-rh="true" rel="alternate" href="https://docs.zkjm.io/docs/seednode-core" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.zkjm.io/docs/seednode-core" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.124cd484.css">
<script src="/assets/js/runtime~main.a0a7549c.js" defer="defer"></script>
<script src="/assets/js/main.f8766115.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/jmzk-logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/jmzk-logo.png" alt="ZKJM Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/jmzk-logo.png" alt="ZKJM Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">JupiterMetaZK</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite" aria-pressed="true"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/intro">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advantages">Advantages</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/zk">Core Components</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/zk">Zero-Knowledge Rollups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/did">Decentralized Identity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tokenomics">Tokenomics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/seednode-core">Seed Node</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/jmdt-node">JMDT Decentralized Node</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/mempool-routing-engine">Mempool Routing Engine (MRE)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/roadmap">Development &amp; Roadmap</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/roadmap">Roadmap</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/use-cases">Use Cases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/use-cases">Use Cases</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Core Components</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Seed Node</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Seed Node</h1></header>
<p>A decentralized <strong>peer directory service</strong> for the JMDT network.<br>
<!-- -->The system maps <strong>PeerIDs ‚Üí IPs/multiaddrs + metadata</strong>, and optionally supports <strong>human-readable names</strong> (<code>alice.node.jmdt</code>) as aliases.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-quick-start">üöÄ Quick Start<a href="#-quick-start" class="hash-link" aria-label="Direct link to üöÄ Quick Start" title="Direct link to üöÄ Quick Start">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-start-postgresql">1. Start PostgreSQL<a href="#1-start-postgresql" class="hash-link" aria-label="Direct link to 1. Start PostgreSQL" title="Direct link to 1. Start PostgreSQL">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Using Docker (recommended)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name postgres-jmns -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=postgres -p 5432:5432 -d postgres:15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Note: Database and schema are automatically created by the service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The service will create the &#x27;jmns&#x27; database and apply the schema automatically</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-start-the-peer-directory-service">2. Start the Peer Directory Service<a href="#2-start-the-peer-directory-service" class="hash-link" aria-label="Direct link to 2. Start the Peer Directory Service" title="Direct link to 2. Start the Peer Directory Service">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Build and start the JMNS service (with automatic database setup)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build -o jmns-service cmd/jmns-service/main.go</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># The service will automatically:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># - Check if PostgreSQL is running (fails if not)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># - Create the &#x27;jmns&#x27; database if it doesn&#x27;t exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># - Apply the schema if tables don&#x27;t exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># - Start the gRPC server</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Custom configuration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service -port 17002 -pg-dsn &quot;postgres://user:pass@host:port/dbname?sslmode=disable&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Using environment variables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=&quot;postgres://postgres:postgres@localhost:5432/jmns?sslmode=disable&quot; ./jmns-service -port 17002</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-start-the-web-ui">3. Start the Web UI<a href="#3-start-the-web-ui" class="hash-link" aria-label="Direct link to 3. Start the Web UI" title="Direct link to 3. Start the Web UI">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Build and start the web UI</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build -o bin/peer-ui cmd/peer-ui/main.go</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/peer-ui</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-access-the-system">4. Access the System<a href="#4-access-the-system" class="hash-link" aria-label="Direct link to 4. Access the System" title="Direct link to 4. Access the System">‚Äã</a></h3>
<ul>
<li><strong>Web UI</strong>: <a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080</a></li>
<li><strong>gRPC API</strong>: localhost:17002</li>
<li><strong>REST API</strong>: <a href="http://localhost:8080/api/peers" target="_blank" rel="noopener noreferrer">http://localhost:8080/api/peers</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-features">‚ú® Features<a href="#-features" class="hash-link" aria-label="Direct link to ‚ú® Features" title="Direct link to ‚ú® Features">‚Äã</a></h2>
<ul>
<li><strong>Canonical identity</strong>:<br>
<!-- -->Every node is anchored to its <strong>PeerID</strong> (Ed25519-based).</li>
<li><strong>Alias support</strong>:<br>
<!-- -->Human-friendly names like <code>alice.node.jmdt</code> mapped to PeerIDs (ENS-style).</li>
<li><strong>Peer records</strong>:<br>
<!-- -->Store IPv4/IPv6, multiaddrs, neighbor connections, and binary status (<code>active/inactive</code>).</li>
<li><strong>V, R, S signature format</strong>:<br>
<!-- -->Uses Ethereum-compatible V, R, S signature components for cryptographic verification.</li>
<li><strong>Auto-generated timestamps</strong>:<br>
<!-- -->Timestamps are automatically generated server-side for consistency.</li>
<li><strong>Auto-active status</strong>:<br>
<!-- -->New peer registrations are automatically marked as active.</li>
<li><strong>Signed updates</strong>:<br>
<!-- -->Only the PeerID owner can update their record.</li>
<li><strong>Fast lookups</strong>:<br>
<!-- -->PostgreSQL-based storage for fast and reliable reads.</li>
<li><strong>Durable source of truth</strong>:<br>
<!-- -->PostgreSQL database stores all peer records and aliases.</li>
<li><strong>Dynamic liveness</strong>:<br>
<!-- -->Heartbeat messages for real-time status tracking.</li>
<li><strong>Auditability</strong>:<br>
<!-- -->Complete audit trail with timestamps and signatures.</li>
<li><strong>Binary Status System</strong>:<br>
<!-- -->Simple active/inactive status with clear visual indicators.</li>
<li><strong>üÜï Automatic Database Setup</strong>:<br>
<!-- -->Service automatically creates database and applies schema on startup.</li>
<li><strong>üÜï Health Checks</strong>:<br>
<!-- -->Comprehensive PostgreSQL connectivity and database validation.</li>
<li><strong>üÜï Fail-Fast Design</strong>:<br>
<!-- -->Service kills itself immediately if PostgreSQL is unavailable.</li>
<li><strong>üÜï IP Geolocation</strong>:<br>
<!-- -->Automatic region detection from IPv4/IPv6 addresses using IP-API (free) or ipapi.co (paid).</li>
<li><strong>üÜï Neighbor Management</strong>:<br>
<!-- -->Full CRUD operations for peer neighbor relationships with proper database normalization.</li>
<li><strong>üÜï Inactive Peer Reporting</strong>:<br>
<!-- -->Comprehensive system for reporting and tracking inactive peers with configurable thresholds.</li>
<li><strong>üÜï Health Check System</strong>:<br>
<!-- -->RPC-based health checks for individual peers with timeout and retry logic.</li>
<li><strong>üÜï Time Window Filtering</strong>:<br>
<!-- -->Reports filtered by configurable time windows for better accuracy and performance.</li>
<li><strong>üÜï Buddy Management</strong>:<br>
<!-- -->Recent buddy tracking with automatic limit management (39 records max) and smart cleanup.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-recent-updates">üîÑ Recent Updates<a href="#-recent-updates" class="hash-link" aria-label="Direct link to üîÑ Recent Updates" title="Direct link to üîÑ Recent Updates">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="peer-directory-v2---normalized-data-model-v40---major-update">Peer Directory v2 - Normalized Data Model (v4.0) - <strong>MAJOR UPDATE</strong><a href="#peer-directory-v2---normalized-data-model-v40---major-update" class="hash-link" aria-label="Direct link to peer-directory-v2---normalized-data-model-v40---major-update" title="Direct link to peer-directory-v2---normalized-data-model-v40---major-update">‚Äã</a></h3>
<p>The peer directory has been completely refactored with a <strong>normalized data model</strong> and <strong>enhanced neighbor management capabilities</strong>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new"><strong>What&#x27;s New:</strong><a href="#whats-new" class="hash-link" aria-label="Direct link to whats-new" title="Direct link to whats-new">‚Äã</a></h4>
<ul>
<li><strong>‚úÖ Normalized Data Model</strong>: Neighbors moved to separate <code>peer_neighbors</code> table</li>
<li><strong>‚úÖ Enhanced Neighbor Management</strong>: Full CRUD operations for neighbor relationships</li>
<li><strong>‚úÖ Inactive Peer Reporting</strong>: Comprehensive system for reporting inactive neighbors</li>
<li><strong>‚úÖ Health Check System</strong>: RPC-based health checks for individual peers</li>
<li><strong>‚úÖ Time Window Filtering</strong>: Reports filtered by configurable time windows</li>
<li><strong>‚úÖ Missed Heartbeat Tracking</strong>: Detailed tracking of consecutive missed heartbeats</li>
<li><strong>‚úÖ Enhanced Registration</strong>: Peers can be registered with initial neighbors</li>
<li><strong>‚úÖ Improved Validation</strong>: Comprehensive input validation and error handling</li>
<li><strong>‚úÖ Database Optimization</strong>: Proper indexes and constraints for performance</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="new-grpc-endpoints"><strong>New gRPC Endpoints:</strong><a href="#new-grpc-endpoints" class="hash-link" aria-label="Direct link to new-grpc-endpoints" title="Direct link to new-grpc-endpoints">‚Äã</a></h4>
<ul>
<li><code>AddNeighbor</code> - Add a neighbor relationship</li>
<li><code>RemoveNeighbor</code> - Remove a neighbor relationship</li>
<li><code>GetNeighbors</code> - Get all neighbors for a peer</li>
<li><code>ReportInactiveNeighbor</code> - Report an inactive neighbor</li>
<li><code>GetInactiveNeighborReportsForSubject</code> - Get reports for a specific peer</li>
<li><code>CheckPeerHealth</code> - Perform health check on a peer</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-model-changes"><strong>Data Model Changes:</strong><a href="#data-model-changes" class="hash-link" aria-label="Direct link to data-model-changes" title="Direct link to data-model-changes">‚Äã</a></h4>
<ul>
<li><strong>Before</strong>: <code>PeerRecord</code> contained <code>neighbors</code> array field</li>
<li><strong>After</strong>: <code>PeerRecord</code> normalized, neighbors stored in separate <code>peer_neighbors</code> table</li>
<li><strong>Benefits</strong>: Better performance, proper relationships, scalable design</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="breaking-changes"><strong>Breaking Changes:</strong><a href="#breaking-changes" class="hash-link" aria-label="Direct link to breaking-changes" title="Direct link to breaking-changes">‚Äã</a></h4>
<ul>
<li><code>PeerRecord</code> no longer contains <code>neighbors</code> field</li>
<li><code>BatchRegister</code> RPC method removed (single-peer focus)</li>
<li><code>RegisterPeer</code>/<code>RegisterPeerWithAlias</code> now accept <code>neighbors</code> parameter</li>
<li>Database schema updated with new tables and indexes</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-health-checks--auto-setup-v31---feature">Database Health Checks &amp; Auto-Setup (v3.1) - <strong>FEATURE</strong><a href="#database-health-checks--auto-setup-v31---feature" class="hash-link" aria-label="Direct link to database-health-checks--auto-setup-v31---feature" title="Direct link to database-health-checks--auto-setup-v31---feature">‚Äã</a></h3>
<p>The service now includes <strong>comprehensive database health checks and automatic setup</strong>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new-1"><strong>What&#x27;s New:</strong><a href="#whats-new-1" class="hash-link" aria-label="Direct link to whats-new-1" title="Direct link to whats-new-1">‚Äã</a></h4>
<ul>
<li><strong>‚úÖ Automatic Database Creation</strong>: Service creates the <code>jmns</code> database if it doesn&#x27;t exist</li>
<li><strong>‚úÖ Schema Auto-Application</strong>: Automatically applies SQL schema if tables are missing</li>
<li><strong>‚úÖ PostgreSQL Health Checks</strong>: Validates PostgreSQL connectivity before starting</li>
<li><strong>‚úÖ Fail-Fast Design</strong>: Service kills itself immediately if PostgreSQL is unavailable</li>
<li><strong>‚úÖ Safe Migration</strong>: Handles existing databases without breaking views or functions</li>
<li><strong>‚úÖ Comprehensive Logging</strong>: Clear status indicators and error messages</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="default-configuration"><strong>Default Configuration:</strong><a href="#default-configuration" class="hash-link" aria-label="Direct link to default-configuration" title="Direct link to default-configuration">‚Äã</a></h4>
<ul>
<li><strong>Database</strong>: <code>jmns</code> (instead of <code>postgres</code>)</li>
<li><strong>Schema Path</strong>: <code>sql/schema.sql</code></li>
<li><strong>Health Check Timeout</strong>: 60 seconds</li>
<li><strong>Connection Validation</strong>: 10 seconds</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="service-startup-process"><strong>Service Startup Process:</strong><a href="#service-startup-process" class="hash-link" aria-label="Direct link to service-startup-process" title="Direct link to service-startup-process">‚Äã</a></h4>
<ol>
<li><strong>PostgreSQL Check</strong>: Verify PostgreSQL is running and accessible</li>
<li><strong>Database Check</strong>: Check if <code>jmns</code> database exists, create if needed</li>
<li><strong>Table Check</strong>: Verify required tables exist, apply schema if needed</li>
<li><strong>Service Creation</strong>: Initialize GORM JMNS service</li>
<li><strong>Final Validation</strong>: Perform comprehensive database validation</li>
<li><strong>Server Start</strong>: Launch gRPC server only if everything is ready</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="error-handling"><strong>Error Handling:</strong><a href="#error-handling" class="hash-link" aria-label="Direct link to error-handling" title="Direct link to error-handling">‚Äã</a></h4>
<ul>
<li><strong>PostgreSQL Not Running</strong>: Service fails immediately with clear error</li>
<li><strong>Permission Issues</strong>: Detailed error messages with remediation hints</li>
<li><strong>Schema Conflicts</strong>: Safe handling of existing views and functions</li>
<li><strong>Connection Timeouts</strong>: Proper timeout handling with retry logic</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gorm-migration-v30---major-update">GORM Migration (v3.0) - <strong>MAJOR UPDATE</strong><a href="#gorm-migration-v30---major-update" class="hash-link" aria-label="Direct link to gorm-migration-v30---major-update" title="Direct link to gorm-migration-v30---major-update">‚Äã</a></h3>
<p>The peer directory has been <strong>completely migrated from direct PostgreSQL connections to GORM ORM</strong>:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-changed"><strong>What Changed:</strong><a href="#what-changed" class="hash-link" aria-label="Direct link to what-changed" title="Direct link to what-changed">‚Äã</a></h4>
<ul>
<li><strong>‚úÖ ORM Integration</strong>: Replaced raw SQL with GORM for type-safe database operations</li>
<li><strong>‚úÖ Automatic Migrations</strong>: GORM AutoMigrate handles schema creation and updates</li>
<li><strong>‚úÖ Type Safety</strong>: Compile-time validation for all database operations</li>
<li><strong>‚úÖ Better Error Handling</strong>: Clear, actionable error messages</li>
<li><strong>‚úÖ Maintainable Code</strong>: Clean repository pattern with separation of concerns</li>
<li><strong>‚úÖ JSON Support</strong>: Proper JSONB handling for labels and metadata</li>
<li><strong>‚úÖ Array Support</strong>: PostgreSQL array types working seamlessly</li>
<li><strong>‚úÖ Foreign Keys</strong>: Proper relationship management between tables</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="technical-improvements"><strong>Technical Improvements:</strong><a href="#technical-improvements" class="hash-link" aria-label="Direct link to technical-improvements" title="Direct link to technical-improvements">‚Äã</a></h4>
<ul>
<li><strong>Database Layer</strong>: <code>pkg/peer/gorm_repository.go</code> - New GORM-based repository</li>
<li><strong>Models</strong>: <code>pkg/peer/models.go</code> - GORM models with proper tags and relationships</li>
<li><strong>Services</strong>: <code>pkg/peer/gorm_jmns_service.go</code> - GORM-integrated service layer</li>
<li><strong>Geolocation</strong>: <code>pkg/peer/geolocation_*.go</code> - IP geolocation with multiple service providers</li>
<li><strong>Dependencies</strong>: Added <code>gorm.io/gorm</code>, <code>gorm.io/driver/postgres</code>, <code>gorm.io/datatypes</code></li>
<li><strong>Migration</strong>: Automatic schema creation with proper dependency order</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="performance-benefits"><strong>Performance Benefits:</strong><a href="#performance-benefits" class="hash-link" aria-label="Direct link to performance-benefits" title="Direct link to performance-benefits">‚Äã</a></h4>
<ul>
<li><strong>Faster Development</strong>: No more manual SQL writing and result scanning</li>
<li><strong>Type Safety</strong>: Compile-time validation prevents runtime errors</li>
<li><strong>Better Maintainability</strong>: Clean, readable code with clear separation of concerns</li>
<li><strong>Automatic Mapping</strong>: No manual data conversion between Go structs and database rows</li>
<li><strong>Query Optimization</strong>: GORM handles query optimization and connection pooling</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="backward-compatibility"><strong>Backward Compatibility:</strong><a href="#backward-compatibility" class="hash-link" aria-label="Direct link to backward-compatibility" title="Direct link to backward-compatibility">‚Äã</a></h4>
<ul>
<li><strong>‚úÖ API Unchanged</strong>: All gRPC endpoints remain the same</li>
<li><strong>‚úÖ Data Preserved</strong>: Existing data is automatically migrated</li>
<li><strong>‚úÖ Same Performance</strong>: No performance degradation</li>
<li><strong>‚úÖ Enhanced Reliability</strong>: Better error handling and type safety</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="binary-status-system-v20">Binary Status System (v2.0)<a href="#binary-status-system-v20" class="hash-link" aria-label="Direct link to Binary Status System (v2.0)" title="Direct link to Binary Status System (v2.0)">‚Äã</a></h3>
<p>The peer directory uses a <strong>simplified binary status system</strong>:</p>
<ul>
<li><strong>‚úÖ Active (1)</strong>: Peer is online and responding</li>
<li><strong>‚ùå Inactive (0)</strong>: Peer is offline or unresponsive</li>
</ul>
<p><strong>Benefits:</strong></p>
<ul>
<li>Cleaner UI with green/red status indicators</li>
<li>Simplified database storage (integer instead of string enums)</li>
<li>Better performance and reduced complexity</li>
<li>Clear visual distinction between peer states</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-ip-geolocation-v32---new-feature">üåç IP Geolocation (v3.2) - <strong>NEW FEATURE</strong><a href="#-ip-geolocation-v32---new-feature" class="hash-link" aria-label="Direct link to -ip-geolocation-v32---new-feature" title="Direct link to -ip-geolocation-v32---new-feature">‚Äã</a></h2>
<p>The peer directory now includes <strong>automatic IP geolocation</strong> to identify regions from peer IP addresses:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new-2"><strong>What&#x27;s New:</strong><a href="#whats-new-2" class="hash-link" aria-label="Direct link to whats-new-2" title="Direct link to whats-new-2">‚Äã</a></h3>
<ul>
<li><strong>‚úÖ Automatic Region Detection</strong>: Detects region from IPv4/IPv6 addresses during peer registration</li>
<li><strong>‚úÖ IP-API Integration</strong>: Uses IP-API service by default (free, no API key required)</li>
<li><strong>‚úÖ ipapi.co Support</strong>: Optional paid service for higher rate limits</li>
<li><strong>‚úÖ Fallback Strategy</strong>: IP-API ‚Üí Basic mapping ‚Üí &quot;unknown&quot;</li>
<li><strong>‚úÖ Non-Intrusive</strong>: Only adds region if not already present in labels</li>
<li><strong>‚úÖ Preserves Existing Data</strong>: Won&#x27;t overwrite existing region labels</li>
<li><strong>‚úÖ IPv4 &amp; IPv6 Support</strong>: Handles both address types from multiaddrs</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="supported-services"><strong>Supported Services:</strong><a href="#supported-services" class="hash-link" aria-label="Direct link to supported-services" title="Direct link to supported-services">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ip-api-default---free"><strong>IP-API</strong> (Default - Free)<a href="#ip-api-default---free" class="hash-link" aria-label="Direct link to ip-api-default---free" title="Direct link to ip-api-default---free">‚Äã</a></h4>
<ul>
<li><strong>Speed</strong>: ~100-500ms per lookup</li>
<li><strong>Accuracy</strong>: Good</li>
<li><strong>Cost</strong>: Free (45 requests/minute)</li>
<li><strong>Network</strong>: Requires internet</li>
<li><strong>Setup</strong>: No API key required</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ipapico-optional---paid"><strong>ipapi.co</strong> (Optional - Paid)<a href="#ipapico-optional---paid" class="hash-link" aria-label="Direct link to ipapico-optional---paid" title="Direct link to ipapico-optional---paid">‚Äã</a></h4>
<ul>
<li><strong>Speed</strong>: ~100-300ms per lookup</li>
<li><strong>Accuracy</strong>: Very good</li>
<li><strong>Cost</strong>: $10/month (1,000 requests)</li>
<li><strong>Network</strong>: Requires internet</li>
<li><strong>Setup</strong>: Requires API key</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration"><strong>Configuration:</strong><a href="#configuration" class="hash-link" aria-label="Direct link to configuration" title="Direct link to configuration">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="environment-variables"><strong>Environment Variables:</strong><a href="#environment-variables" class="hash-link" aria-label="Direct link to environment-variables" title="Direct link to environment-variables">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Choose your provider (optional - defaults to ip-api)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export GEO_PROVIDER=&quot;ip-api&quot;  # Only IP-API is supported</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># API key (if using ipapi.co)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export IPAPI_CO_KEY=&quot;your_key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="programmatic-configuration"><strong>Programmatic Configuration:</strong><a href="#programmatic-configuration" class="hash-link" aria-label="Direct link to programmatic-configuration" title="Direct link to programmatic-configuration">‚Äã</a></h4>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;seedNodes/pkg/peer&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Option 1: Use IP-API (default, free)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> peer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GeoLocationConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Provider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ip-api&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Option 2: Use ipapi.co (paid, requires API key)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> peer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GeoLocationConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Provider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ip-api&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    APIKey</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">   </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;your_api_key&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Option 3: Use basic mapping (no internet required)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> peer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">GeoLocationConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Provider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;basic&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">geoService</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> err </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> peer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">NewGeoLocationServiceFromConfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="region-format"><strong>Region Format:</strong><a href="#region-format" class="hash-link" aria-label="Direct link to region-format" title="Direct link to region-format">‚Äã</a></h3>
<p>The system returns regions in the format: <code>COUNTRY-REGION-CITY</code></p>
<p><strong>Examples:</strong></p>
<ul>
<li><code>US-VA-Ashburn</code> (United States, Virginia, Ashburn)</li>
<li><code>DE-BW-Berlin</code> (Germany, Baden-W√ºrttemberg, Berlin)</li>
<li><code>JP-13-Tokyo</code> (Japan, Tokyo, Tokyo)</li>
<li><code>GB-ENG-London</code> (United Kingdom, England, London)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-integration"><strong>Automatic Integration:</strong><a href="#automatic-integration" class="hash-link" aria-label="Direct link to automatic-integration" title="Direct link to automatic-integration">‚Äã</a></h3>
<p>Region detection happens automatically during peer registration:</p>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// This will automatically detect and add region information</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">record </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;</span><span class="token plain">peer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SignedPeerRecord</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PeerID</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">     </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12D3KooW...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Multiaddrs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/ip4/8.8.8.8/tcp/4001/p2p/12D3KooW...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">     </span><span class="token keyword" style="font-style:italic">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Region will be added automatically</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">err </span><span class="token operator" style="color:rgb(137, 221, 255)">:=</span><span class="token plain"> jmnsService</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">RegisterPeer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> record</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// record.Labels will now contain region information</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-storage"><strong>Database Storage:</strong><a href="#database-storage" class="hash-link" aria-label="Direct link to database-storage" title="Direct link to database-storage">‚Äã</a></h3>
<p>Region information is stored in the existing <code>labels</code> JSONB field:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;region&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;US-VA-Ashburn&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;region_detected_at&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1703123456&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;role&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;validator&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup-guide"><strong>Setup Guide:</strong><a href="#setup-guide" class="hash-link" aria-label="Direct link to setup-guide" title="Direct link to setup-guide">‚Äã</a></h3>
<p>For detailed setup instructions, see <a href="/docs/GEOLOCATION_SETUP.md">GEOLOCATION_SETUP.md</a></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="Ô∏è-peer-weights-system-v33---new-feature">‚öñÔ∏è Peer Weights System (v3.3) - <strong>NEW FEATURE</strong><a href="#Ô∏è-peer-weights-system-v33---new-feature" class="hash-link" aria-label="Direct link to Ô∏è-peer-weights-system-v33---new-feature" title="Direct link to Ô∏è-peer-weights-system-v33---new-feature">‚Äã</a></h2>
<p>The peer directory now supports <strong>peer weights</strong> for priority-based routing and load balancing:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new-3"><strong>What&#x27;s New:</strong><a href="#whats-new-3" class="hash-link" aria-label="Direct link to whats-new-3" title="Direct link to whats-new-3">‚Äã</a></h3>
<ul>
<li><strong>‚úÖ Weight Assignment</strong>: Peers can be assigned numerical weights (0.0-1.0)</li>
<li><strong>‚úÖ UpdatePeerWeights API</strong>: New gRPC method to update peer weights</li>
<li><strong>‚úÖ Database Storage</strong>: Weights stored as REAL type in PostgreSQL</li>
<li><strong>‚úÖ Signature Verification</strong>: Weight updates require cryptographic signatures</li>
<li><strong>‚úÖ Sequence Management</strong>: Proper sequence number handling for updates</li>
<li><strong>‚úÖ Type Safety</strong>: Full type safety with float64 in Go, float in protobuf</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases"><strong>Use Cases:</strong><a href="#use-cases" class="hash-link" aria-label="Direct link to use-cases" title="Direct link to use-cases">‚Äã</a></h3>
<ul>
<li><strong>Load Balancing</strong>: Higher weights indicate more capable peers</li>
<li><strong>Priority Routing</strong>: Prefer peers with higher weights for operations</li>
<li><strong>Resource Allocation</strong>: Weights represent computational power or bandwidth</li>
<li><strong>Consensus Participation</strong>: Influence voting power in consensus mechanisms</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-usage"><strong>API Usage:</strong><a href="#api-usage" class="hash-link" aria-label="Direct link to api-usage" title="Direct link to api-usage">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Update peer weights via gRPC</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;weights&quot;: 0.95,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;v&quot;: &quot;0x1c&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;r&quot;: &quot;0x1234567890abcdef...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;s&quot;: &quot;0x1234567890abcdef...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/UpdatePeerWeights</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="weight-values"><strong>Weight Values:</strong><a href="#weight-values" class="hash-link" aria-label="Direct link to weight-values" title="Direct link to weight-values">‚Äã</a></h3>
<ul>
<li><strong>Range</strong>: 0.0 to 1.0 (recommended)</li>
<li><strong>Default</strong>: 0.0 (no special weight)</li>
<li><strong>Examples</strong>:<!-- -->
<ul>
<li><code>0.0</code> - Standard peer</li>
<li><code>0.5</code> - Medium priority</li>
<li><code>0.85</code> - High priority</li>
<li><code>1.0</code> - Maximum priority</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-buddy-management-v41---new-feature">üë• Buddy Management (v4.1) - <strong>NEW FEATURE</strong><a href="#-buddy-management-v41---new-feature" class="hash-link" aria-label="Direct link to -buddy-management-v41---new-feature" title="Direct link to -buddy-management-v41---new-feature">‚Äã</a></h2>
<p>The peer directory now includes <strong>buddy management</strong> functionality to maintain a list of recently interacted peers:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new-4"><strong>What&#x27;s New:</strong><a href="#whats-new-4" class="hash-link" aria-label="Direct link to whats-new-4" title="Direct link to whats-new-4">‚Äã</a></h3>
<ul>
<li><strong>‚úÖ Recent Buddy Tracking</strong>: Maintains a list of recently interacted peers</li>
<li><strong>‚úÖ Automatic Limit Management</strong>: Automatically maintains a maximum of 39 records</li>
<li><strong>‚úÖ Smart Cleanup</strong>: Removes oldest 13 records when limit is exceeded</li>
<li><strong>‚úÖ Exclusion Filtering</strong>: ListBuddy returns all peers except recent buddies</li>
<li><strong>‚úÖ Transaction Safety</strong>: All operations are wrapped in database transactions</li>
<li><strong>‚úÖ Non-Existent Peer Handling</strong>: Skips peers that don&#x27;t exist in the system</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works"><strong>How It Works:</strong><a href="#how-it-works" class="hash-link" aria-label="Direct link to how-it-works" title="Direct link to how-it-works">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="updatebuddy"><strong>UpdateBuddy</strong><a href="#updatebuddy" class="hash-link" aria-label="Direct link to updatebuddy" title="Direct link to updatebuddy">‚Äã</a></h4>
<ul>
<li>Adds new peer IDs to the recent buddy list</li>
<li>Automatically maintains the 39-record limit</li>
<li>Updates timestamps for existing buddies</li>
<li>Returns count of added and removed records</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="listbuddy"><strong>ListBuddy</strong><a href="#listbuddy" class="hash-link" aria-label="Direct link to listbuddy" title="Direct link to listbuddy">‚Äã</a></h4>
<ul>
<li>Returns all peers in the system</li>
<li><strong>Excludes</strong> peers that are in the recent buddy list</li>
<li>Useful for finding new peers to interact with</li>
<li>Maintains full peer record information</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-schema"><strong>Database Schema:</strong><a href="#database-schema" class="hash-link" aria-label="Direct link to database-schema" title="Direct link to database-schema">‚Äã</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- Recent buddy table (max 39 records, oldest 13 removed when limit reached)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TABLE</span><span class="token plain"> recent_buddy </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    id </span><span class="token keyword" style="font-style:italic">SERIAL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    peer_id </span><span class="token keyword" style="font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">255</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">REFERENCES</span><span class="token plain"> peer_records</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">peer_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">ON</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DELETE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">CASCADE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    added_at </span><span class="token keyword" style="font-style:italic">BIGINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> EXTRACT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">EPOCH </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">NOW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    created_at </span><span class="token keyword" style="font-style:italic">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">WITH</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">NOW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">UNIQUE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">peer_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases-1"><strong>Use Cases:</strong><a href="#use-cases-1" class="hash-link" aria-label="Direct link to use-cases-1" title="Direct link to use-cases-1">‚Äã</a></h3>
<ul>
<li><strong>Peer Discovery</strong>: Find new peers to connect to (exclude recent buddies)</li>
<li><strong>Load Distribution</strong>: Avoid repeatedly connecting to the same peers</li>
<li><strong>Network Expansion</strong>: Discover fresh peers for better network coverage</li>
<li><strong>Connection Management</strong>: Track recently used connections for optimization</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-usage-1"><strong>API Usage:</strong><a href="#api-usage-1" class="hash-link" aria-label="Direct link to api-usage-1" title="Direct link to api-usage-1">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Update recent buddy list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peer_ids&quot;: [&quot;12D3KooWTestPeer123456789&quot;, &quot;12D3KooWAnotherPeer987654321&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/UpdateBuddy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># List peers excluding recent buddies</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{}&#x27; localhost:17002 peerpb.PeerDirectory/ListBuddy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="response-examples"><strong>Response Examples:</strong><a href="#response-examples" class="hash-link" aria-label="Direct link to response-examples" title="Direct link to response-examples">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="updatebuddy-response"><strong>UpdateBuddy Response:</strong><a href="#updatebuddy-response" class="hash-link" aria-label="Direct link to updatebuddy-response" title="Direct link to updatebuddy-response">‚Äã</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;accepted&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">true</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;message&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Successfully updated buddy list. Added: 2, Removed: 0&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;addedCount&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;removedCount&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="listbuddy-response"><strong>ListBuddy Response:</strong><a href="#listbuddy-response" class="hash-link" aria-label="Direct link to listbuddy-response" title="Direct link to listbuddy-response">‚Äã</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;peers&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;peerId&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12D3KooWNewPeer123456789&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;multiaddrs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/ip4/127.0.0.1/tcp/4001/p2p/12D3KooWNewPeer123456789&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;currentStatus&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;PEER_STATUS_ACTIVE&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;weights&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token property">&quot;labels&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;role&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;validator&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;region&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;US-CA&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;totalCount&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="automatic-limit-management"><strong>Automatic Limit Management:</strong><a href="#automatic-limit-management" class="hash-link" aria-label="Direct link to automatic-limit-management" title="Direct link to automatic-limit-management">‚Äã</a></h3>
<ul>
<li><strong>Maximum Records</strong>: 39 peers in recent buddy list</li>
<li><strong>Cleanup Trigger</strong>: Every UpdateBuddy call</li>
<li><strong>Cleanup Amount</strong>: Removes oldest 13 records when limit exceeded</li>
<li><strong>Database Function</strong>: <code>maintain_recent_buddy_limit()</code> handles cleanup automatically</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="Ô∏è-gorm-architecture">üèóÔ∏è GORM Architecture<a href="#Ô∏è-gorm-architecture" class="hash-link" aria-label="Direct link to üèóÔ∏è GORM Architecture" title="Direct link to üèóÔ∏è GORM Architecture">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-layer-structure">Database Layer Structure<a href="#database-layer-structure" class="hash-link" aria-label="Direct link to Database Layer Structure" title="Direct link to Database Layer Structure">‚Äã</a></h3>
<p>The system now uses a clean GORM-based architecture:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pkg/peer/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ models.go              # GORM models with proper tags</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ gorm_repository.go     # GORM repository implementation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ gorm_jmns_service.go   # GORM-integrated service layer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ gorm_db.go            # Database connection utilities</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ types.go              # Internal type definitions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ geolocation.go        # Basic geolocation service with lookup tables</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ geolocation_api.go    # HTTP API services (IP-API, ipapi.co, IPStack)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ geolocation_config.go # Configuration management for geolocation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îî‚îÄ‚îÄ geolocation_test.go   # Unit tests for geolocation functionality</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="gorm-models">GORM Models<a href="#gorm-models" class="hash-link" aria-label="Direct link to GORM Models" title="Direct link to GORM Models">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="peerrecord">PeerRecord<a href="#peerrecord" class="hash-link" aria-label="Direct link to PeerRecord" title="Direct link to PeerRecord">‚Äã</a></h4>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> PeerRecord </span><span class="token keyword" style="font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PeerID        </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;primaryKey;column:peer_id;type:varchar(255)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Multiaddrs    pq</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StringArray </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;type:text[];not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Seq           </span><span class="token builtin" style="color:rgb(130, 170, 255)">uint64</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null;default:1&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    FirstCreated  </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LastUpdated   </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ActiveFrom    </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CurrentStatus </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null;default:1&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Neighbors     pq</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StringArray </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;type:text[];default:&#x27;{}&#x27;&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Labels        datatypes</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">JSON </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;type:jsonb;default:&#x27;{}&#x27;&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Weights       </span><span class="token builtin" style="color:rgb(130, 170, 255)">float64</span><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;type:real;default:0.0&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    V             </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    R             </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    S             </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CreatedAt     time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Time      </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;autoCreateTime&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    UpdatedAt     time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Time      </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;autoUpdateTime&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="gormpeeralias">GormPeerAlias<a href="#gormpeeralias" class="hash-link" aria-label="Direct link to GormPeerAlias" title="Direct link to GormPeerAlias">‚Äã</a></h4>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> GormPeerAlias </span><span class="token keyword" style="font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Name        </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;primaryKey;column:name;type:varchar(255)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PeerID      </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null;column:peer_id;type:varchar(255)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Created     </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">     </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    LastUpdated </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">     </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    V           </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    R           </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    S           </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CreatedAt   time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Time </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;autoCreateTime&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    UpdatedAt   time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Time </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;autoUpdateTime&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="heartbeat">Heartbeat<a href="#heartbeat" class="hash-link" aria-label="Direct link to Heartbeat" title="Direct link to Heartbeat">‚Äã</a></h4>
<div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">type</span><span class="token plain"> Heartbeat </span><span class="token keyword" style="font-style:italic">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ID         </span><span class="token builtin" style="color:rgb(130, 170, 255)">uint64</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;primaryKey;autoIncrement&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    PeerID     </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null;column:peer_id;type:varchar(255)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Timestamp  </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Status     </span><span class="token builtin" style="color:rgb(130, 170, 255)">int64</span><span class="token plain">          </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Multiaddrs pq</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StringArray </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;type:text[]&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    V          </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    R          </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    S          </span><span class="token builtin" style="color:rgb(130, 170, 255)">string</span><span class="token plain">         </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;not null&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    CreatedAt  time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Time      </span><span class="token string" style="color:rgb(195, 232, 141)">`gorm:&quot;autoCreateTime&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-gorm-features">Key GORM Features<a href="#key-gorm-features" class="hash-link" aria-label="Direct link to Key GORM Features" title="Direct link to Key GORM Features">‚Äã</a></h3>
<ul>
<li><strong>AutoMigrate</strong>: Automatic schema creation and updates</li>
<li><strong>Type Safety</strong>: Compile-time validation for all operations</li>
<li><strong>JSON Support</strong>: Native JSONB handling with <code>datatypes.JSON</code></li>
<li><strong>Array Support</strong>: PostgreSQL arrays with <code>pq.StringArray</code></li>
<li><strong>Timestamps</strong>: Automatic <code>CreatedAt</code> and <code>UpdatedAt</code> management</li>
<li><strong>Foreign Keys</strong>: Proper relationship constraints</li>
<li><strong>Connection Pooling</strong>: Efficient database connection management</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-schema-1">Database Schema<a href="#database-schema-1" class="hash-link" aria-label="Direct link to Database Schema" title="Direct link to Database Schema">‚Äã</a></h3>
<p>The system uses PostgreSQL with the following key tables:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="peer_records">peer_records<a href="#peer_records" class="hash-link" aria-label="Direct link to peer_records" title="Direct link to peer_records">‚Äã</a></h4>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TABLE</span><span class="token plain"> peer_records </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    peer_id </span><span class="token keyword" style="font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">255</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    multiaddrs </span><span class="token keyword" style="font-style:italic">TEXT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    seq </span><span class="token keyword" style="font-style:italic">BIGINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    first_created </span><span class="token keyword" style="font-style:italic">BIGINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    last_updated </span><span class="token keyword" style="font-style:italic">BIGINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    active_from </span><span class="token keyword" style="font-style:italic">BIGINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    current_status </span><span class="token keyword" style="font-style:italic">INTEGER</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    neighbors </span><span class="token keyword" style="font-style:italic">TEXT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{}&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    labels JSONB </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;{}&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    weights </span><span class="token keyword" style="font-style:italic">REAL</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">           </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- NEW: Peer weight field</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    v </span><span class="token keyword" style="font-style:italic">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    r </span><span class="token keyword" style="font-style:italic">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    s </span><span class="token keyword" style="font-style:italic">TEXT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">NOT</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    created_at </span><span class="token keyword" style="font-style:italic">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">WITH</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">NOW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    updated_at </span><span class="token keyword" style="font-style:italic">TIMESTAMP</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">WITH</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">TIME</span><span class="token plain"> ZONE </span><span class="token keyword" style="font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">NOW</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Key Fields</strong>:</p>
<ul>
<li><code>weights</code>: Float value (0.0-1.0) representing peer priority/weight</li>
<li><code>labels</code>: JSONB field for metadata (region, role, etc.)</li>
<li><code>neighbors</code>: Array of connected peer IDs</li>
<li><code>current_status</code>: Binary status (1=active, 0=inactive)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-data-models">üì¶ Data Models<a href="#-data-models" class="hash-link" aria-label="Direct link to üì¶ Data Models" title="Direct link to üì¶ Data Models">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="signed-peer-record-v3-gorm">Signed Peer Record v3 (GORM)<a href="#signed-peer-record-v3-gorm" class="hash-link" aria-label="Direct link to Signed Peer Record v3 (GORM)" title="Direct link to Signed Peer Record v3 (GORM)">‚Äã</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;peer_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12D3KooW...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;multiaddrs&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/ip4/1.2.3.4/tcp/4001/p2p/12D3KooW...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;seq&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;first_created&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1735689600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;last_updated&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1735689600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;active_from&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1735689600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;current_status&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;PEER_STATUS_ACTIVE&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;neighbors&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12D3KooX...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;12D3KooY...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;labels&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;role&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fullnode&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token property">&quot;region&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;apac&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;weights&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.85</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;v&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x00&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;r&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0x1234567890abcdef...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;s&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;0xabcdef1234567890...&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h1>seedNodes</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="one-shot-dependency-install">One-shot Dependency Install<a href="#one-shot-dependency-install" class="hash-link" aria-label="Direct link to One-shot Dependency Install" title="Direct link to One-shot Dependency Install">‚Äã</a></h2>
<p>Run this once to install protoc plugins, download Go deps, and generate stubs:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd seedNodes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./scripts/install_deps.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This performs:</p>
<ul>
<li>Installs <code>protoc-gen-go</code> and <code>protoc-gen-go-grpc</code></li>
<li>Runs <code>go mod tidy</code> + <code>go mod download</code></li>
<li>Generates gRPC code from <code>api/proto/redis_streams.proto</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-binaries">Build Binaries<a href="#build-binaries" class="hash-link" aria-label="Direct link to Build Binaries" title="Direct link to Build Binaries">‚Äã</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build ./cmd/pg-cud-consumer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build ./cmd/hrw-exporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build ./cmd/seednode-grpc</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build ./cmd/jmns-service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="run">Run<a href="#run" class="hash-link" aria-label="Direct link to Run" title="Direct link to Run">‚Äã</a></h2>
<p>Ensure the Redis Streams gRPC microservice is running (<code>../Redis-Streams/./RDS.sh run-microservice</code>) and Postgres is reachable.</p>
<p>Example env and run commands:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># CUD Consumer (applies to Postgres)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_ADDR=0.0.0.0:16001 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_TOPIC_CUD=seednode.cud \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_CONSUMER_GROUP=seednode-cud-group \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_CONSUMER_NAME=seednode-cud-consumer-1 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./pg-cud-consumer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Exporter (publishes table pages)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_ADDR=0.0.0.0:16001 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RS_TOPIC_READ=seednode.read \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./hrw-exporter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## SeedNode gRPC Orchestrator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Start the SeedNode gRPC server (publishes CUD to Redis Streams and serves reads from Postgres):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>PG_DSN=postgres://postgres<!-- -->:postgres<!-- -->@localhost:5432/postgres?sslmode=disable <br>
<!-- -->RS_ADDR=0.0.0.0:16001 <br>
<!-- -->RS_TOPIC_CUD=seednode.cud <br>
<!-- -->./seednode-grpc --port 17001</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Test with grpcurl (install via `brew install grpcurl` on macOS):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### BatchUpsert (queues to Redis Streams; processed by the pg-cud-consumer)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;items&quot;: [{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;tx_hash&quot;: &quot;0xtest001&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;epoch&quot;: 123,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;primary_shard_id&quot;: 5,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;replica_shard_ids&quot;: [6,7],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;routing_engine_id&quot;: &quot;local-dev-1&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17001 seednodepb.SeedNode/BatchUpsert</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="batchdelete">BatchDelete<a href="#batchdelete" class="hash-link" aria-label="Direct link to BatchDelete" title="Direct link to BatchDelete">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{&quot;tx_hashes&quot;:[&quot;0xtest001&quot;]}&#x27; localhost:17001 seednodepb.SeedNode/BatchDelete</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="get-reads-directly-from-postgres">Get (reads directly from Postgres)<a href="#get-reads-directly-from-postgres" class="hash-link" aria-label="Direct link to Get (reads directly from Postgres)" title="Direct link to Get (reads directly from Postgres)">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{&quot;tx_hash&quot;:&quot;0xtest001&quot;}&#x27; localhost:17001 seednodepb.SeedNode/Get</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="list-keyset-pagination">List (keyset pagination)<a href="#list-keyset-pagination" class="hash-link" aria-label="Direct link to List (keyset pagination)" title="Direct link to List (keyset pagination)">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{&quot;after_tx_hash&quot;:&quot;&quot;,&quot;limit&quot;:10}&#x27; localhost:17001 seednodepb.SeedNode/List</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Note: Keep <code>pg-cud-consumer</code> running to apply CUD messages to Postgres.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="peer-directory-service-jmns">Peer Directory Service (JMNS)<a href="#peer-directory-service-jmns" class="hash-link" aria-label="Direct link to Peer Directory Service (JMNS)" title="Direct link to Peer Directory Service (JMNS)">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-1-using-docker-postgresql">Option 1: Using Docker PostgreSQL<a href="#option-1-using-docker-postgresql" class="hash-link" aria-label="Direct link to Option 1: Using Docker PostgreSQL" title="Direct link to Option 1: Using Docker PostgreSQL">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start PostgreSQL (using Docker)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name postgres-jmns -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=postgres -p 5432:5432 -d postgres:15</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create database schema</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -i postgres-jmns psql -U postgres -d postgres &lt; sql/schema.sql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start the peer directory service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=&quot;postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable&quot; ./jmns-service --port 17002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="option-2-using-native-postgresql-ubuntudebian">Option 2: Using Native PostgreSQL (Ubuntu/Debian)<a href="#option-2-using-native-postgresql-ubuntudebian" class="hash-link" aria-label="Direct link to Option 2: Using Native PostgreSQL (Ubuntu/Debian)" title="Direct link to Option 2: Using Native PostgreSQL (Ubuntu/Debian)">‚Äã</a></h3>
<p><strong>Quick Setup (Recommended):</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Run the automated setup script</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./scripts/setup_postgres_ubuntu.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start the peer directory service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=&quot;postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable&quot; ./jmns-service --port 17002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Manual Setup:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Install PostgreSQL</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo apt install postgresql postgresql-contrib</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start PostgreSQL service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo systemctl start postgresql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo systemctl enable postgresql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create database and user</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo -u postgres psql -c &quot;CREATE DATABASE postgres;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo -u postgres psql -c &quot;CREATE USER postgres WITH PASSWORD &#x27;postgres&#x27;;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo -u postgres psql -c &quot;GRANT ALL PRIVILEGES ON DATABASE postgres TO postgres;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create database schema</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psql -h localhost -U postgres -d postgres &lt; sql/schema.sql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start the peer directory service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PG_DSN=&quot;postgres://postgres:postgres@localhost:5432/postgres?sslmode=disable&quot; ./jmns-service --port 17002</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing">Testing<a href="#testing" class="hash-link" aria-label="Direct link to Testing" title="Direct link to Testing">‚Äã</a></h3>
<p>Test the peer directory service:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Run the comprehensive test suite</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_jmns_service.sh</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Run other tests</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-web-ui">üåê Web UI<a href="#-web-ui" class="hash-link" aria-label="Direct link to üåê Web UI" title="Direct link to üåê Web UI">‚Äã</a></h2>
<p>The peer directory includes a modern web interface for viewing and managing peers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="start-the-web-ui">Start the Web UI<a href="#start-the-web-ui" class="hash-link" aria-label="Direct link to Start the Web UI" title="Direct link to Start the Web UI">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Build the peer UI service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">go build -o bin/peer-ui cmd/peer-ui/main.go</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start the web UI (requires JMNS service running on port 17002)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./bin/peer-ui</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The web UI will be available at: <strong><a href="http://localhost:8080" target="_blank" rel="noopener noreferrer">http://localhost:8080</a></strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="features">Features<a href="#features" class="hash-link" aria-label="Direct link to Features" title="Direct link to Features">‚Äã</a></h3>
<ul>
<li><strong>üìä Dashboard</strong>: View peer statistics and status overview</li>
<li><strong>üîç Peer Browser</strong>: Browse all registered peers with filtering</li>
<li><strong>üìà Real-time Status</strong>: Live updates of peer status (active/inactive)</li>
<li><strong>üé® Simple UI</strong>: Clean, responsive interface with status indicators</li>
<li><strong>üîé Search &amp; Filter</strong>: Filter peers by status, labels, and more</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-endpoints">API Endpoints<a href="#api-endpoints" class="hash-link" aria-label="Direct link to API Endpoints" title="Direct link to API Endpoints">‚Äã</a></h3>
<p>The web UI exposes REST API endpoints:</p>
<ul>
<li><code>GET /api/peers</code> - List all peers with optional filtering</li>
<li><code>GET /api/peers/{peer_id}</code> - Get specific peer details</li>
<li><code>GET /api/peers/by-alias/{alias}</code> - Get peer by alias</li>
</ul>
<p>Example API usage:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># List all peers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:8080/api/peers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Filter by status</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl &quot;http://localhost:8080/api/peers?status=active&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Get specific peer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost:8080/api/peers/12D3KooWTestPeer123456789</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-grpc-api-reference">üîå gRPC API Reference<a href="#-grpc-api-reference" class="hash-link" aria-label="Direct link to üîå gRPC API Reference" title="Direct link to üîå gRPC API Reference">‚Äã</a></h2>
<p>The peer directory service exposes the following gRPC endpoints:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="core-operations">Core Operations<a href="#core-operations" class="hash-link" aria-label="Direct link to Core Operations" title="Direct link to Core Operations">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>RegisterPeer</code></td><td>Register a new peer</td><td><code>RegisterPeerRequest</code></td><td><code>RegisterPeerResponse</code></td></tr><tr><td><code>RegisterPeerWithAlias</code></td><td>Register peer with alias in one operation</td><td><code>RegisterPeerWithAliasRequest</code></td><td><code>RegisterPeerWithAliasResponse</code></td></tr><tr><td><code>UpdatePeer</code></td><td>Update existing peer</td><td><code>UpdatePeerRequest</code></td><td><code>UpdatePeerResponse</code></td></tr><tr><td><code>UpdatePeerWeights</code></td><td>Update peer weights</td><td><code>UpdatePeerWeightsRequest</code></td><td><code>UpdatePeerWeightsResponse</code></td></tr><tr><td><code>GetPeer</code></td><td>Get peer by ID</td><td><code>GetPeerRequest</code></td><td><code>GetPeerResponse</code></td></tr><tr><td><code>DeletePeer</code></td><td>Delete peer</td><td><code>DeletePeerRequest</code></td><td><code>DeletePeerResponse</code></td></tr><tr><td><code>ListPeers</code></td><td>List peers with filtering</td><td><code>PeerListRequest</code></td><td><code>PeerListResponse</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="alias-operations">Alias Operations<a href="#alias-operations" class="hash-link" aria-label="Direct link to Alias Operations" title="Direct link to Alias Operations">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>CreateAlias</code></td><td>Create peer alias</td><td><code>CreateAliasRequest</code></td><td><code>CreateAliasResponse</code></td></tr><tr><td><code>GetPeerByAlias</code></td><td>Get peer by alias</td><td><code>GetPeerByAliasRequest</code></td><td><code>GetPeerByAliasResponse</code></td></tr><tr><td><code>DeleteAlias</code></td><td>Delete alias</td><td><code>DeleteAliasRequest</code></td><td><code>DeleteAliasResponse</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="neighbor-management-new">Neighbor Management (NEW)<a href="#neighbor-management-new" class="hash-link" aria-label="Direct link to Neighbor Management (NEW)" title="Direct link to Neighbor Management (NEW)">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>AddNeighbor</code></td><td>Add a neighbor relationship</td><td><code>AddNeighborRequest</code></td><td><code>AddNeighborResponse</code></td></tr><tr><td><code>RemoveNeighbor</code></td><td>Remove a neighbor relationship</td><td><code>RemoveNeighborRequest</code></td><td><code>RemoveNeighborResponse</code></td></tr><tr><td><code>GetNeighbors</code></td><td>Get all neighbors for a peer</td><td><code>GetNeighborsRequest</code></td><td><code>GetNeighborsResponse</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inactive-peer-reporting-new">Inactive Peer Reporting (NEW)<a href="#inactive-peer-reporting-new" class="hash-link" aria-label="Direct link to Inactive Peer Reporting (NEW)" title="Direct link to Inactive Peer Reporting (NEW)">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>ReportInactiveNeighbor</code></td><td>Report an inactive neighbor</td><td><code>ReportInactiveNeighborRequest</code></td><td><code>ReportInactiveNeighborResponse</code></td></tr><tr><td><code>GetInactiveNeighborReportsForSubject</code></td><td>Get reports for a specific peer</td><td><code>GetInactiveNeighborReportsForSubjectRequest</code></td><td><code>GetInactiveNeighborReportsForSubjectResponse</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="health-checks-new">Health Checks (NEW)<a href="#health-checks-new" class="hash-link" aria-label="Direct link to Health Checks (NEW)" title="Direct link to Health Checks (NEW)">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>CheckPeerHealth</code></td><td>Perform health check on a peer</td><td><code>HealthCheckRequest</code></td><td><code>HealthCheckResponse</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="heartbeat--service-operations">Heartbeat &amp; Service Operations<a href="#heartbeat--service-operations" class="hash-link" aria-label="Direct link to Heartbeat &amp; Service Operations" title="Direct link to Heartbeat &amp; Service Operations">‚Äã</a></h3>
<table><thead><tr><th>Method</th><th>Description</th><th>Request</th><th>Response</th></tr></thead><tbody><tr><td><code>SendHeartbeat</code></td><td>Send peer heartbeat</td><td><code>SendHeartbeatRequest</code></td><td><code>SendHeartbeatResponse</code></td></tr><tr><td><code>HealthCheck</code></td><td>Service health check</td><td><code>Empty</code></td><td><code>Empty</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="status-values">Status Values<a href="#status-values" class="hash-link" aria-label="Direct link to Status Values" title="Direct link to Status Values">‚Äã</a></h3>
<p>The system uses a <strong>binary status system</strong>:</p>
<ul>
<li><code>PEER_STATUS_ACTIVE</code> (1) - Peer is online and active</li>
<li><code>PEER_STATUS_INACTIVE</code> (0) - Peer is offline or inactive</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="weights-system">Weights System<a href="#weights-system" class="hash-link" aria-label="Direct link to Weights System" title="Direct link to Weights System">‚Äã</a></h3>
<p>The <strong>weights field</strong> allows peers to be assigned numerical weights for various purposes:</p>
<ul>
<li><strong>Load Balancing</strong>: Higher weights can indicate more capable peers</li>
<li><strong>Priority Routing</strong>: Peers with higher weights may be preferred for certain operations</li>
<li><strong>Resource Allocation</strong>: Weights can represent computational power, bandwidth, or reliability</li>
<li><strong>Consensus Participation</strong>: Weights can influence voting power in consensus mechanisms</li>
</ul>
<p><strong>Weight Values</strong>:</p>
<ul>
<li>Range: <code>0.0</code> to <code>1.0</code> (recommended)</li>
<li>Default: <code>0.0</code> (no special weight)</li>
<li>Type: <code>float64</code> in Go, <code>float</code> in protobuf, <code>REAL</code> in PostgreSQL</li>
</ul>
<p><strong>Usage Examples</strong>:</p>
<ul>
<li><code>0.0</code> - Standard peer with no special weight</li>
<li><code>0.5</code> - Medium priority peer</li>
<li><code>0.85</code> - High priority peer</li>
<li><code>1.0</code> - Maximum priority peer</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-grpc-calls">Example gRPC Calls<a href="#example-grpc-calls" class="hash-link" aria-label="Direct link to Example gRPC Calls" title="Direct link to Example gRPC Calls">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># List all peers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{}&#x27; localhost:17002 peerpb.PeerDirectory/ListPeers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Register a new peer with neighbors (NEW)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerRecord&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;multiaddrs&quot;: [&quot;/ip4/127.0.0.1/tcp/4001/p2p/12D3KooWTestPeer123456789&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;seq&quot;: 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;currentStatus&quot;: &quot;PEER_STATUS_ACTIVE&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;labels&quot;: {&quot;region&quot;: &quot;local&quot;, &quot;role&quot;: &quot;testnode&quot;},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;v&quot;: &quot;0x00&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;r&quot;: &quot;0x1234567890abcdef...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;s&quot;: &quot;0xabcdef1234567890...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;neighbors&quot;: [&quot;12D3KooWNeighbor1&quot;, &quot;12D3KooWNeighbor2&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/RegisterPeer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Add a neighbor (NEW)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;neighborId&quot;: &quot;12D3KooWNewNeighbor&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;v&quot;: &quot;0x00&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;r&quot;: &quot;0x1111111111111111...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;s&quot;: &quot;0x2222222222222222...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/AddNeighbor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Get neighbors for a peer (NEW)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/GetNeighbors</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Report inactive neighbor (NEW)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;report&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;reporterPeerId&quot;: &quot;12D3KooWReporterPeer&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;subjectPeerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;lastSeenTimestamp&quot;: 1735689600,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;reason&quot;: &quot;missed_heartbeats&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;reportedAt&quot;: 1735689700,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;missedHeartbeatCount&quot;: 3,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;v&quot;: &quot;0x00&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;r&quot;: &quot;0x5555555555555555...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;s&quot;: &quot;0x6666666666666666...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/ReportInactiveNeighbor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Check peer health (NEW)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/CheckPeerHealth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Register a peer with alias in one operation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerRecord&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;multiaddrs&quot;: [&quot;/ip4/127.0.0.1/tcp/4001/p2p/12D3KooWTestPeer123456789&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;seq&quot;: 1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;currentStatus&quot;: &quot;PEER_STATUS_ACTIVE&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;labels&quot;: {&quot;region&quot;: &quot;local&quot;, &quot;role&quot;: &quot;testnode&quot;},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;v&quot;: &quot;0x00&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;r&quot;: &quot;0x1234567890abcdef...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;s&quot;: &quot;0xabcdef1234567890...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;alias&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;name&quot;: &quot;alice.node.jmdt&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;v&quot;: &quot;0x00&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;r&quot;: &quot;0x9876543210fedcba...&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;s&quot;: &quot;0xfedcba9876543210...&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/RegisterPeerWithAlias</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Get peer by ID</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{&quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;}&#x27; localhost:17002 peerpb.PeerDirectory/GetPeer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Update peer weights</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;weights&quot;: 0.95,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;v&quot;: &quot;0x1c&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;r&quot;: &quot;0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;s&quot;: &quot;0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/UpdatePeerWeights</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Update recent buddy list</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;peer_ids&quot;: [&quot;12D3KooWTestPeer123456789&quot;, &quot;12D3KooWAnotherPeer987654321&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/UpdateBuddy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># List peers excluding recent buddies</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{}&#x27; localhost:17002 peerpb.PeerDirectory/ListBuddy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Send heartbeat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">grpcurl -plaintext -d &#x27;{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;heartbeat&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;peerId&quot;: &quot;12D3KooWTestPeer123456789&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;timestamp&quot;: 1735689600,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;status&quot;: &quot;PEER_STATUS_ACTIVE&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;multiaddrs&quot;: [&quot;/ip4/127.0.0.1/tcp/4001/p2p/12D3KooWTestPeer123456789&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;signature&quot;: &quot;heartbeat-signature&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}&#x27; localhost:17002 peerpb.PeerDirectory/SendHeartbeat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-project-structure">üìÅ Project Structure<a href="#-project-structure" class="hash-link" aria-label="Direct link to üìÅ Project Structure" title="Direct link to üìÅ Project Structure">‚Äã</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">seedNodes/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ cmd/                          # Application entry points</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ jmns-service/            # Main peer directory service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ peer-ui/                 # Web UI for peer management</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ hrw-exporter/            # HRW exporter service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ pg-cud-consumer/         # PostgreSQL CUD consumer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ seednode-grpc/           # Seed node gRPC service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ pkg/                         # Core packages</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ peer/                    # Peer directory implementation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.go            # GORM database models</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gorm_repository.go   # GORM repository layer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gorm_jmns_service.go # Main service implementation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peer_neighbor_repository.go # Neighbor management repository</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inactive_neighbor_report_repository.go # Inactive reporting repository</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inactive_neighbor_service.go # Inactive neighbor business logic</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inactive_neighbor_config.go # Configuration for inactive reporting</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peer_health_checker.go # Health check system</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils.go             # Utility functions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peer_directory_v2_test.go # Unit tests for v2 features</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geolocation.go       # Basic geolocation service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geolocation_api.go   # HTTP API services</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geolocation_config.go # Configuration management</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ geolocation_test.go  # Unit tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ config/                  # Configuration management</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ hrw/                     # HRW (Hash Ring Weight) implementation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ pgrepo/                  # PostgreSQL repository utilities</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ rsclient/                # Redis Streams client</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ api/                         # Protocol definitions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ peer/                    # Peer directory gRPC API</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ proto/                   # Redis Streams gRPC API</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ sql/                         # Database schema</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ schema.sql               # PostgreSQL schema definition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ test/                        # Test scripts and utilities</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_peer_directory_v2.sh # Peer Directory v2 comprehensive tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_schema_migration.sh  # Database schema migration tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_region_detection.sh # IP geolocation tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_register_peer.sh    # Peer registration tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_jmns_service.sh     # Service integration tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îú‚îÄ‚îÄ test_db_health.sh        # Database health tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ test_results_v2.md       # Test results documentation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ examples/                    # Example code and demos</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îÇ   ‚îî‚îÄ‚îÄ geolocation_demo.go      # IP geolocation demo</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ scripts/                     # Setup and utility scripts</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ bin/                         # Built binaries</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ go.mod                       # Go module definition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ go.sum                       # Go module checksums</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ README.md                    # This file</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îî‚îÄ‚îÄ GEOLOCATION_SETUP.md         # IP geolocation setup guide</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-testing">üß™ Testing<a href="#-testing" class="hash-link" aria-label="Direct link to üß™ Testing" title="Direct link to üß™ Testing">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-organization">Test Organization<a href="#test-organization" class="hash-link" aria-label="Direct link to Test Organization" title="Direct link to Test Organization">‚Äã</a></h3>
<p>All test files have been organized in the <code>test/</code> folder:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">test/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ test_db_health.sh      # Database health checks and auto-setup tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ test_jmns_service.sh   # Comprehensive JMNS service tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îú‚îÄ‚îÄ test_register_peer.sh  # Peer registration tests</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚îî‚îÄ‚îÄ test_results.md        # Test results and documentation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-tests">Running Tests<a href="#running-tests" class="hash-link" aria-label="Direct link to Running Tests" title="Direct link to Running Tests">‚Äã</a></h3>
<ul>
<li>
<p><strong>Database Health Check Tests</strong> (NEW):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Test database health checks and automatic setup</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_db_health.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Tests:</p>
<ul>
<li>PostgreSQL connection validation</li>
<li>Automatic database creation</li>
<li>Schema application</li>
<li>Table existence validation</li>
<li>Error scenarios and fail-fast behavior</li>
</ul>
</li>
<li>
<p><strong>JMNS Service Tests</strong> (GORM-based):</p>
</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_jmns_service.sh  # Comprehensive test suite</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Peer Registration</strong>:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_register_peer.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>IP Geolocation</strong> (NEW):</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_region_detection.sh  # Test IP geolocation functionality</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Peer Directory v2</strong> (NEW):</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_peer_directory_v2.sh  # Test new normalized data model and features</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./test/test_schema_migration.sh  # Test database schema migration</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-coverage">Test Coverage<a href="#test-coverage" class="hash-link" aria-label="Direct link to Test Coverage" title="Direct link to Test Coverage">‚Äã</a></h3>
<p>The JMNS service test suite covers:</p>
<ul>
<li>‚úÖ Health checks</li>
<li>‚úÖ Peer registration and updates</li>
<li>‚úÖ Alias creation and management</li>
<li>‚úÖ IP geolocation and region detection</li>
<li>‚úÖ Heartbeat functionality</li>
<li>‚úÖ Batch operations</li>
<li>‚úÖ Label filtering and pagination</li>
<li>‚úÖ Error handling and validation</li>
<li>‚úÖ <strong>Neighbor management (NEW)</strong></li>
<li>‚úÖ <strong>Inactive peer reporting (NEW)</strong></li>
<li>‚úÖ <strong>Health check system (NEW)</strong></li>
<li>‚úÖ <strong>Data model normalization (NEW)</strong></li>
<li>‚úÖ <strong>Time window filtering (NEW)</strong></li>
<li>‚úÖ <strong>Database schema migration (NEW)</strong></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-troubleshooting">üîß Troubleshooting<a href="#-troubleshooting" class="hash-link" aria-label="Direct link to üîß Troubleshooting" title="Direct link to üîß Troubleshooting">‚Äã</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues--solutions">Common Issues &amp; Solutions<a href="#common-issues--solutions" class="hash-link" aria-label="Direct link to Common Issues &amp; Solutions" title="Direct link to Common Issues &amp; Solutions">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="postgresql-not-running"><strong>PostgreSQL Not Running</strong><a href="#postgresql-not-running" class="hash-link" aria-label="Direct link to postgresql-not-running" title="Direct link to postgresql-not-running">‚Äã</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: PostgreSQL is not running or not accessible</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Solution</strong>: Start PostgreSQL service</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># macOS with Homebrew</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">brew services start postgresql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Linux with systemd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo systemctl start postgresql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name postgres-jmns -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=postgres -p 5432:5432 -d postgres:15</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="database-permission-issues"><strong>Database Permission Issues</strong><a href="#database-permission-issues" class="hash-link" aria-label="Direct link to database-permission-issues" title="Direct link to database-permission-issues">‚Äã</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: failed to create database &#x27;jmns&#x27;: permission denied</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Solution</strong>: Grant database creation privileges</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- Connect to PostgreSQL as superuser</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psql </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">U postgres</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- Grant privileges to your user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">ALTER</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">USER</span><span class="token plain"> your_username CREATEDB</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="schema-application-failed"><strong>Schema Application Failed</strong><a href="#schema-application-failed" class="hash-link" aria-label="Direct link to schema-application-failed" title="Direct link to schema-application-failed">‚Äã</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: failed to apply schema: syntax error in SQL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Solution</strong>: Check schema file syntax and permissions</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Verify schema file exists and is readable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ls -la sql/schema.sql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Check file permissions</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chmod 644 sql/schema.sql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="service-wont-start"><strong>Service Won&#x27;t Start</strong><a href="#service-wont-start" class="hash-link" aria-label="Direct link to service-wont-start" title="Direct link to service-wont-start">‚Äã</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: Database initialization failed</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Solution</strong>: Check logs for specific error details</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Run with verbose logging</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service -pg-dsn=&quot;postgres://postgres:postgres@localhost:5432/jmns?sslmode=disable&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="protobuf-field-errors"><strong>Protobuf Field Errors</strong><a href="#protobuf-field-errors" class="hash-link" aria-label="Direct link to protobuf-field-errors" title="Direct link to protobuf-field-errors">‚Äã</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ERROR: message type peerpb.DeleteAliasRequest has no known field named alias_name</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Solution</strong>: Use correct field names in gRPC calls</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Correct</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;alias&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;alice.node.jmdt&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Incorrect</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token property">&quot;alias_name&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;alice.node.jmdt&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-configuration">Service Configuration<a href="#service-configuration" class="hash-link" aria-label="Direct link to Service Configuration" title="Direct link to Service Configuration">‚Äã</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="environment-variables-1"><strong>Environment Variables</strong><a href="#environment-variables-1" class="hash-link" aria-label="Direct link to environment-variables-1" title="Direct link to environment-variables-1">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># PostgreSQL connection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export PG_DSN=&quot;postgres://user:pass@host:port/dbname?sslmode=disable&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Schema file path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">export SCHEMA_PATH=&quot;/path/to/schema.sql&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Start service</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="command-line-options"><strong>Command Line Options</strong><a href="#command-line-options" class="hash-link" aria-label="Direct link to command-line-options" title="Direct link to command-line-options">‚Äã</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Custom port</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service -port 8080</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Custom database</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service -pg-dsn &quot;postgres://user:pass@host:port/custom_db?sslmode=disable&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Custom schema path</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./jmns-service -schema-path &quot;/path/to/custom/schema.sql&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging--monitoring">Logging &amp; Monitoring<a href="#logging--monitoring" class="hash-link" aria-label="Direct link to Logging &amp; Monitoring" title="Direct link to Logging &amp; Monitoring">‚Äã</a></h3>
<p>The service provides detailed logging with status indicators:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Starting JMNS Service...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">PostgreSQL DSN: postgres://postgres:postgres@localhost:5432/jmns?sslmode=disable</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Schema path: sql/schema.sql</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Performing database health checks...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì PostgreSQL connection successful</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Database &#x27;jmns&#x27; exists</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Required tables exist</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Database initialization completed successfully</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Creating GORM JMNS service...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Performing final database validation...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Database validation successful</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Simple Peer Directory gRPC server starting on port 17002</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Local PeerID: 12D3KooW...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">‚úì Service ready to accept connections</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="local-redis-streams-and-postgres">Local Redis Streams and Postgres<a href="#local-redis-streams-and-postgres" class="hash-link" aria-label="Direct link to Local Redis Streams and Postgres" title="Direct link to Local Redis Streams and Postgres">‚Äã</a></h2>
<ul>
<li>Start Redis Streams microservice (in ../Redis-Streams):</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">./RDS.sh start</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./RDS.sh run-microservice</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Ensure Postgres is reachable and PG_DSN is set before running consumers/exporters.</li>
</ul>
<pre tabindex="0" class="codeBlockStandalone_MEMb thin-scrollbar codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><code class="codeBlockLines_e6Vv"></code></pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/JupiterMetaZK/docs/edit/main/docs/seednode-core.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tokenomics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tokenomics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/jmdt-node"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">P2P-Communication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-quick-start" class="table-of-contents__link toc-highlight">üöÄ Quick Start</a><ul><li><a href="#1-start-postgresql" class="table-of-contents__link toc-highlight">1. Start PostgreSQL</a></li><li><a href="#2-start-the-peer-directory-service" class="table-of-contents__link toc-highlight">2. Start the Peer Directory Service</a></li><li><a href="#3-start-the-web-ui" class="table-of-contents__link toc-highlight">3. Start the Web UI</a></li><li><a href="#4-access-the-system" class="table-of-contents__link toc-highlight">4. Access the System</a></li></ul></li><li><a href="#-features" class="table-of-contents__link toc-highlight">‚ú® Features</a></li><li><a href="#-recent-updates" class="table-of-contents__link toc-highlight">üîÑ Recent Updates</a><ul><li><a href="#peer-directory-v2---normalized-data-model-v40---major-update" class="table-of-contents__link toc-highlight">Peer Directory v2 - Normalized Data Model (v4.0) - <strong>MAJOR UPDATE</strong></a></li><li><a href="#database-health-checks--auto-setup-v31---feature" class="table-of-contents__link toc-highlight">Database Health Checks &amp; Auto-Setup (v3.1) - <strong>FEATURE</strong></a></li><li><a href="#gorm-migration-v30---major-update" class="table-of-contents__link toc-highlight">GORM Migration (v3.0) - <strong>MAJOR UPDATE</strong></a></li><li><a href="#binary-status-system-v20" class="table-of-contents__link toc-highlight">Binary Status System (v2.0)</a></li></ul></li><li><a href="#-ip-geolocation-v32---new-feature" class="table-of-contents__link toc-highlight">üåç IP Geolocation (v3.2) - <strong>NEW FEATURE</strong></a><ul><li><a href="#whats-new-2" class="table-of-contents__link toc-highlight"><strong>What&#39;s New:</strong></a></li><li><a href="#supported-services" class="table-of-contents__link toc-highlight"><strong>Supported Services:</strong></a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight"><strong>Configuration:</strong></a></li><li><a href="#region-format" class="table-of-contents__link toc-highlight"><strong>Region Format:</strong></a></li><li><a href="#automatic-integration" class="table-of-contents__link toc-highlight"><strong>Automatic Integration:</strong></a></li><li><a href="#database-storage" class="table-of-contents__link toc-highlight"><strong>Database Storage:</strong></a></li><li><a href="#setup-guide" class="table-of-contents__link toc-highlight"><strong>Setup Guide:</strong></a></li></ul></li><li><a href="#Ô∏è-peer-weights-system-v33---new-feature" class="table-of-contents__link toc-highlight">‚öñÔ∏è Peer Weights System (v3.3) - <strong>NEW FEATURE</strong></a><ul><li><a href="#whats-new-3" class="table-of-contents__link toc-highlight"><strong>What&#39;s New:</strong></a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight"><strong>Use Cases:</strong></a></li><li><a href="#api-usage" class="table-of-contents__link toc-highlight"><strong>API Usage:</strong></a></li><li><a href="#weight-values" class="table-of-contents__link toc-highlight"><strong>Weight Values:</strong></a></li></ul></li><li><a href="#-buddy-management-v41---new-feature" class="table-of-contents__link toc-highlight">üë• Buddy Management (v4.1) - <strong>NEW FEATURE</strong></a><ul><li><a href="#whats-new-4" class="table-of-contents__link toc-highlight"><strong>What&#39;s New:</strong></a></li><li><a href="#how-it-works" class="table-of-contents__link toc-highlight"><strong>How It Works:</strong></a></li><li><a href="#database-schema" class="table-of-contents__link toc-highlight"><strong>Database Schema:</strong></a></li><li><a href="#use-cases-1" class="table-of-contents__link toc-highlight"><strong>Use Cases:</strong></a></li><li><a href="#api-usage-1" class="table-of-contents__link toc-highlight"><strong>API Usage:</strong></a></li><li><a href="#response-examples" class="table-of-contents__link toc-highlight"><strong>Response Examples:</strong></a></li><li><a href="#automatic-limit-management" class="table-of-contents__link toc-highlight"><strong>Automatic Limit Management:</strong></a></li></ul></li><li><a href="#Ô∏è-gorm-architecture" class="table-of-contents__link toc-highlight">üèóÔ∏è GORM Architecture</a><ul><li><a href="#database-layer-structure" class="table-of-contents__link toc-highlight">Database Layer Structure</a></li><li><a href="#gorm-models" class="table-of-contents__link toc-highlight">GORM Models</a></li><li><a href="#key-gorm-features" class="table-of-contents__link toc-highlight">Key GORM Features</a></li><li><a href="#database-schema-1" class="table-of-contents__link toc-highlight">Database Schema</a></li></ul></li><li><a href="#-data-models" class="table-of-contents__link toc-highlight">üì¶ Data Models</a><ul><li><a href="#signed-peer-record-v3-gorm" class="table-of-contents__link toc-highlight">Signed Peer Record v3 (GORM)</a></li></ul></li><li><a href="#one-shot-dependency-install" class="table-of-contents__link toc-highlight">One-shot Dependency Install</a></li><li><a href="#build-binaries" class="table-of-contents__link toc-highlight">Build Binaries</a></li><li><a href="#run" class="table-of-contents__link toc-highlight">Run</a></li><li><a href="#peer-directory-service-jmns" class="table-of-contents__link toc-highlight">Peer Directory Service (JMNS)</a><ul><li><a href="#option-1-using-docker-postgresql" class="table-of-contents__link toc-highlight">Option 1: Using Docker PostgreSQL</a></li><li><a href="#option-2-using-native-postgresql-ubuntudebian" class="table-of-contents__link toc-highlight">Option 2: Using Native PostgreSQL (Ubuntu/Debian)</a></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a></li></ul></li><li><a href="#-web-ui" class="table-of-contents__link toc-highlight">üåê Web UI</a><ul><li><a href="#start-the-web-ui" class="table-of-contents__link toc-highlight">Start the Web UI</a></li><li><a href="#features" class="table-of-contents__link toc-highlight">Features</a></li><li><a href="#api-endpoints" class="table-of-contents__link toc-highlight">API Endpoints</a></li></ul></li><li><a href="#-grpc-api-reference" class="table-of-contents__link toc-highlight">üîå gRPC API Reference</a><ul><li><a href="#core-operations" class="table-of-contents__link toc-highlight">Core Operations</a></li><li><a href="#alias-operations" class="table-of-contents__link toc-highlight">Alias Operations</a></li><li><a href="#neighbor-management-new" class="table-of-contents__link toc-highlight">Neighbor Management (NEW)</a></li><li><a href="#inactive-peer-reporting-new" class="table-of-contents__link toc-highlight">Inactive Peer Reporting (NEW)</a></li><li><a href="#health-checks-new" class="table-of-contents__link toc-highlight">Health Checks (NEW)</a></li><li><a href="#heartbeat--service-operations" class="table-of-contents__link toc-highlight">Heartbeat &amp; Service Operations</a></li><li><a href="#status-values" class="table-of-contents__link toc-highlight">Status Values</a></li><li><a href="#weights-system" class="table-of-contents__link toc-highlight">Weights System</a></li><li><a href="#example-grpc-calls" class="table-of-contents__link toc-highlight">Example gRPC Calls</a></li></ul></li><li><a href="#-project-structure" class="table-of-contents__link toc-highlight">üìÅ Project Structure</a></li><li><a href="#-testing" class="table-of-contents__link toc-highlight">üß™ Testing</a><ul><li><a href="#test-organization" class="table-of-contents__link toc-highlight">Test Organization</a></li><li><a href="#running-tests" class="table-of-contents__link toc-highlight">Running Tests</a></li><li><a href="#test-coverage" class="table-of-contents__link toc-highlight">Test Coverage</a></li></ul></li><li><a href="#-troubleshooting" class="table-of-contents__link toc-highlight">üîß Troubleshooting</a><ul><li><a href="#common-issues--solutions" class="table-of-contents__link toc-highlight">Common Issues &amp; Solutions</a></li><li><a href="#service-configuration" class="table-of-contents__link toc-highlight">Service Configuration</a></li><li><a href="#logging--monitoring" class="table-of-contents__link toc-highlight">Logging &amp; Monitoring</a></li></ul></li><li><a href="#local-redis-streams-and-postgres" class="table-of-contents__link toc-highlight">Local Redis Streams and Postgres</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://zkjm.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">JupiterMetaZK</a></li><li class="footer__item"><a href="https://github.com/JupiterMetaZK/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2025 JupiterMetaZK. All Rights Reserved.</div></div></div></footer></div>
</body>
</html>